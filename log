File "SpocLibs/Samples/Bitonic_sort/dune", line 18, characters 2-17:
18 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: mods=4 types=6
File "SpocLibs/Samples/Bitonic_sort/Bitonic_sort.ml", lines 22-37, characters 2-10:
22 | ..[%kernel
23 |     fun (v : float32 vector) (j : int32) (k : int32) ->
24 |       let i = thread_idx_x + block_dim_x * block_idx_x in
25 |       let ixj = Math.xor i j in
26 |       let temp = mut 0. in
...
34 |           temp := v.%[ixj] ;
35 |           v.%[ixj] <- v.%[i] ;
36 |           v.%[i] <- temp)
37 |       end]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Benchmarks/BFS/dune", line 6, characters 2-17:
6 |   (pps sarek_ppx))
      ^^^^^^^^^^^^^^^
Sarek PPX: mods=4 types=6
File "SpocLibs/Benchmarks/BFS/BFS.ml", lines 44-60, characters 19-1:
44 | ...................[%kernel fun (g_graph_nodes : node vector) (g_graph_edges : int32 vector) (g_graph_mask : int32 vector) (g_updating_graph_mask : int32 vector) (g_graph_visited : int32 vector) (g_cost : int32 vector) (no_of_nodes : int32) ->
45 |   let open Std in
46 |   let tid = (block_idx_x * [%global max_threads_per_block]) + thread_idx_x in
47 |   if (tid < no_of_nodes && (1 = g_graph_mask.%[tid]) ) then
48 |     (
...
57 |           )
58 |       done;
59 |     )
60 | ]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_ktype_record.ml", lines 9-18, characters 4-28:
 9 | ....[%kernel
10 |       let module Types = struct
11 |         type point = {x : float32; y : float32}
12 |       end in
13 |       fun (src : point vector) (dst : point vector) (n : int32) ->
14 |         let tid = thread_idx_x in
15 |         if tid < n then
16 |           let p = src.(tid) in
17 |           let next : point = {x = p.x +. 1.0; y = p.y} in
18 |           dst.(tid) <- next]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Benchmarks/Pi/dune", line 6, characters 2-17:
6 |   (pps sarek_ppx))
      ^^^^^^^^^^^^^^^
Sarek PPX: mods=4 types=6
File "SpocLibs/Benchmarks/Pi/Pi.ml", lines 6-21, characters 13-1:
 6 | .............[%kernel fun (rX : float32 vector) (rY : float32 vector) (inside : int32 vector) (n : int32) ->
 7 |   let open Std in
 8 |   let open Math in
 9 |   let open Float32 in
10 |   let i = thread_idx_x + block_idx_x * block_dim_x in
...
18 |         | _ -> "atomicAdd (inside,1)"
19 |       ]
20 |   end
21 | ]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_convention_kernel.ml", lines 12-21, characters 4-57:
12 | ....[%kernel
13 |       fun (points : Geometry_lib.point vector)
14 |           (distances : float32 vector)
15 |           (n : int32) ->
16 |         let tid = thread_idx_x + (block_dim_x * block_idx_x) in
17 |         if tid < n then
18 |           let p = points.(tid) in
19 |           let x = p.x in
20 |           let y = p.y in
21 |           distances.(tid) <- sqrt ((x *. x) +. (y *. y))]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_pragma.ml", lines 4-13, characters 2-21:
 4 | ..[%kernel
 5 |     fun (a : int32 vector) (n : int32) ->
 6 |       let tid = thread_idx_x in
 7 |       let sum = mut 0l in
 8 |       pragma
 9 |         ["unroll"]
10 |         (for i = 0 to 3 do
11 |            sum := sum + a.(tid + i)
12 |          done) ;
13 |       a.(tid) <- sum]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_klet_variant.ml", lines 9-18, characters 4-52:
 9 | ....[%kernel
10 |       let module Types = struct
11 |         type shape = Circle of float32 | Square of float32
12 |       end in
13 |       let area (s : shape) : float32 =
14 |         match s with Circle r -> 3.14 *. r *. r | Square x -> x *. x
15 |       in
16 |       fun (src : shape vector) (dst : float32 vector) (n : int32) ->
17 |         let tid = thread_idx_x in
18 |         if tid < n then dst.(tid) <- area src.(tid)]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_klet_fun.ml", lines 9-13, characters 4-61:
 9 | ....[%kernel
10 |       let add_scale (x : float32) (y : float32) : float32 = x +. (2.0 *. y) in
11 |       fun (src : float32 vector) (dst : float32 vector) (n : int32) ->
12 |         let tid = thread_idx_x in
13 |         if tid < n then dst.(tid) <- add_scale src.(tid) 3.0]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_module_const.ml", lines 10-14, characters 4-56:
10 | ....[%kernel
11 |       let (scale : float32) = 2.0 in
12 |       fun (src : float32 vector) (dst : float32 vector) (n : int32) ->
13 |         let tid = thread_idx_x + (block_dim_x * block_idx_x) in
14 |         if tid < n then dst.(tid) <- scale *. src.(tid)]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_vector_add.ml", lines 53-59, characters 4-54:
53 | ....[%kernel
54 |       fun (a : float32 vector)
55 |           (b : float32 vector)
56 |           (c : float32 vector)
57 |           (n : int32) ->
58 |         let tid = thread_idx_x + (block_dim_x * block_idx_x) in
59 |         if tid < n then c.(tid) <- a.(tid) +. b.(tid)]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_cross_module_type.ml", lines 11-20, characters 4-33:
11 | ....[%kernel
12 |       fun (xs : float32 vector)
13 |           (ys : float32 vector)
14 |           (dst : float32 vector)
15 |           (n : int32) ->
16 |         let tid = thread_idx_x + (block_idx_x * block_dim_x) in
17 |         if tid < n then
18 |           let open Registered_defs in
19 |           let p : Registered_defs.vec2 = {x = xs.(tid); y = ys.(tid)} in
20 |           dst.(tid) <- add_vec p]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_visibility_private.ml", lines 10-16, characters 4-81:
10 | ....[%kernel
11 |       fun (xs : float32 vector)
12 |           (ys : float32 vector)
13 |           (dst : float32 vector)
14 |           (n : int32) ->
15 |         let tid = thread_idx_x + (block_idx_x * block_dim_x) in
16 |         if tid < n then dst.(tid) <- Visibility_lib.public_add xs.(tid) ys.(tid)]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_ray_ppx.ml", lines 10-63, characters 4-32:
10 | ....[%kernel
11 |       let module Types = struct
12 |         type vec3 = {x : float32; y : float32; z : float32}
13 |       end in
14 |       let make_vec3 (x : float32) (y : float32) (z : float32) : vec3 =
...
60 |             let b = 1.0 in
61 |             out.(idx) <- r ;
62 |             out.(idx + 1) <- g ;
63 |             out.(idx + 2) <- b)]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_ktype_helper.ml", lines 9-22, characters 4-59:
 9 | ....[%kernel
10 |       let module Types = struct
11 |         type point = {x : float32; y : float32}
12 |       end in
13 |       let make_point (x : float32) (y : float32) : point = {x; y} in
...
19 |         let tid = thread_idx_x + (block_idx_x * block_dim_x) in
20 |         if tid < n then
21 |           let p = make_point xv.(tid) yv.(tid) in
22 |           dst.(tid) <- sqrt ((p.x *. p.x) +. (p.y *. p.y))]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_nbody_ppx.ml", lines 10-46, characters 4-26:
10 | ....[%kernel
11 |       let module Types = struct
12 |         type particle = {x : float32; y : float32; z : float32}
13 |       end in
14 |       let make_p (x : float32) (y : float32) (z : float32) : particle =
...
43 |           done ;
44 |           ax.(tid) <- fx ;
45 |           ay.(tid) <- fy ;
46 |           az.(tid) <- fz)]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_registered_type.ml", lines 13-21, characters 4-59:
13 | ....[%kernel
14 |       fun (xs : float32 vector)
15 |           (ys : float32 vector)
16 |           (dst : float32 vector)
17 |           (n : int32) ->
18 |         let tid = thread_idx_x + (block_idx_x * block_dim_x) in
19 |         if tid < n then
20 |           let p = {x = xs.(tid); y = ys.(tid)} in
21 |           dst.(tid) <- sqrt ((p.x *. p.x) +. (p.y *. p.y))]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Benchmarks/NBody/dune", line 6, characters 2-17:
6 |   (pps sarek_ppx))
      ^^^^^^^^^^^^^^^
Sarek PPX: mods=4 types=6
File "SpocLibs/Benchmarks/NBody/NBody_ppx.ml", lines 61-99, characters 2-42:
61 | ..[%kernel
62 |     fun (p : float4 vector) (v : float4 vector) (dt : float32) (n : int32) ->
63 |       let open Std in
64 |       let i = (block_idx_x * block_dim_x) + thread_idx_x in
65 |       if i < n then (
...
96 |         done ;
97 |         v.(i).x <- v.(i).x +. (dt *. fx) ;
98 |         v.(i).y <- v.(i).y +. (dt *. fy) ;
99 |         v.(i).z <- v.(i).z +. (dt *. fz))]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_registered_variant.ml", lines 13-20, characters 4-45:
13 | ....[%kernel
14 |       fun (xs : float32 vector) (dst : float32 vector) (n : int32) ->
15 |         let tid = thread_idx_x + (block_idx_x * block_dim_x) in
16 |         if tid < n then
17 |           let c = if xs.(tid) > 0.0 then Value xs.(tid) else Red in
18 |           match c with
19 |           | Red -> dst.(tid) <- 0.0
20 |           | Value v -> dst.(tid) <- v +. 1.0]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/comparison/dune", line 29, characters 2-17:
29 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/comparison/test_comparison.ml", line 117, characters 2-49:
117 |   [%kernel fun (v : int32 vector) -> v.(0) <- 42]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/e2e/dune", line 22, characters 2-17:
22 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: sarek.module binding add_vec
Sarek PPX: register module fun add_vec
Sarek PPX: sarek.module binding scale_fun
Sarek PPX: register module fun scale_fun
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/e2e/test_registered_const.ml", lines 11-19, characters 4-56:
11 | ....[%kernel
12 |       fun (xs : float32 vector)
13 |           (ys : float32 vector)
14 |           (dst : float32 vector)
15 |           (n : int32) ->
16 |         let tid = thread_idx_x + (block_idx_x * block_dim_x) in
17 |         if tid < n then
18 |           let open Registered_defs in
19 |           dst.(tid) <- scale_fun (xs.(tid) +. ys.(tid))]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/comparison/dune", line 18, characters 2-17:
18 |   (pps sarek_ppx))
       ^^^^^^^^^^^^^^^
Sarek PPX: mods=4 types=6
File "SpocLibs/Sarek_test/comparison/test_ktype.ml", lines 17-20, characters 4-39:
17 | ....[%kernel
18 |       fun (v : float32 vector) (n : int32) ->
19 |         let tid = thread_idx_x in
20 |         if tid < n then v.(tid) <- 1.0]
Error: Sarek internal error: Type mismatch: expected int32, got float32{}
File "SpocLibs/Sarek_test/unit/test_env.ml", line 75, characters 40-48:
75 |         (match found.vi_type with TPrim TFloat32 -> true | _ -> false) ;
                                             ^^^^^^^^
Error: This variant pattern is expected to have type prim_type
       There is no constructor TFloat32 within type prim_type
File "SpocLibs/Sarek_test/unit/test_types.ml", line 54, characters 32-40:
54 |     (match t_float32 with TPrim TFloat32 -> true | _ -> false)
                                     ^^^^^^^^
Error: This variant pattern is expected to have type prim_type
       There is no constructor TFloat32 within type prim_type
File "SpocLibs/Sarek_test/unit/test_typer.ml", line 301, characters 14-22:
301 |       | TPrim TFloat32 -> ()
                    ^^^^^^^^
Error: This variant pattern is expected to have type prim_type
       There is no constructor TFloat32 within type prim_type
