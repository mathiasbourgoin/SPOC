(tests
 (names
  test_types
  test_env
  test_typer
  test_lower
  test_parse
  test_core_primitives
  test_tailrec
  test_scheme
  test_mono)
 ; Link sarek_stdlib to trigger auto-registration of intrinsics
 (libraries sarek_ppx_lib sarek_stdlib alcotest ppxlib)
 (preprocess
  (pps ppxlib.metaquot)))

; Fusion tests use sarek library directly (no ppx needed)

(test
 (name test_fusion)
 (libraries sarek)
 (flags
  (:standard -ccopt -L/opt/cuda/lib64 -cclib -lnvrtc)))

; Interpreter tests removed - Sarek_interp was legacy SPOC-dependent

; Float32 module tests

(test
 (name test_float32)
 (libraries sarek)
 (flags
  (:standard -ccopt -L/opt/cuda/lib64 -cclib -lnvrtc)))

; Float64 module tests

(test
 (name test_float64)
 (libraries sarek.float64)
 (flags
  (:standard -ccopt -L/opt/cuda/lib64 -cclib -lnvrtc)))
