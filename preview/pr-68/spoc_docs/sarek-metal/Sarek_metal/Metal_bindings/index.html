<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Metal_bindings (sarek-metal.Sarek_metal.Metal_bindings)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">sarek-metal</a> &#x00BB; <a href="../index.html">Sarek_metal</a> &#x00BB; Metal_bindings</nav><header class="odoc-preamble"><h1>Module <code><span>Sarek_metal.Metal_bindings</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#library-loading">Library Loading</a></li><li><a href="#objective-c-runtime-helpers">Objective-C Runtime Helpers</a></li><li><a href="#foundation-helpers">Foundation Helpers</a></li><li><a href="#metal-device-api">Metal Device API</a></li><li><a href="#command-queue-api">Command Queue API</a></li><li><a href="#command-buffer-api">Command Buffer API</a></li><li><a href="#buffer-api">Buffer API</a></li><li><a href="#library-api">Library API</a></li><li><a href="#compute-pipeline-api">Compute Pipeline API</a></li><li><a href="#compute-command-encoder-api">Compute Command Encoder API</a></li><li><a href="#memory-management">Memory Management</a></li></ul></nav></div><div class="odoc-content"><h2 id="library-loading"><a href="#library-loading" class="anchor"></a>Library Loading</h2><div class="odoc-spec"><div class="spec value anchored" id="val-metal_lib"><a href="#val-metal_lib" class="anchor"></a><code><span><span class="keyword">val</span> metal_lib : <span><span><span class="xref-unresolved">Dl</span>.library option</span> <span class="xref-unresolved">Stdlib</span>.Lazy.t</span></span></code></div><div class="spec-doc"><p>Load Metal framework dynamically (lazy)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_available"><a href="#val-is_available" class="anchor"></a><code><span><span class="keyword">val</span> is_available : <span>unit <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check if Metal library is available</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_metal_lib"><a href="#val-get_metal_lib" class="anchor"></a><code><span><span class="keyword">val</span> get_metal_lib : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Dl</span>.library</span></code></div><div class="spec-doc"><p>Get Metal library, raising if not available</p></div></div><h2 id="objective-c-runtime-helpers"><a href="#objective-c-runtime-helpers" class="anchor"></a>Objective-C Runtime Helpers</h2><div class="odoc-spec"><div class="spec value anchored" id="val-objc_lib"><a href="#val-objc_lib" class="anchor"></a><code><span><span class="keyword">val</span> objc_lib : <span><span><span class="xref-unresolved">Dl</span>.library option</span> <span class="xref-unresolved">Stdlib</span>.Lazy.t</span></span></code></div><div class="spec-doc"><p>We need libobjc for calling Objective-C methods</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_objc_lib"><a href="#val-get_objc_lib" class="anchor"></a><code><span><span class="keyword">val</span> get_objc_lib : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Dl</span>.library</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-objc_msgSend_lazy"><a href="#val-objc_msgSend_lazy" class="anchor"></a><code><span><span class="keyword">val</span> objc_msgSend_lazy : 
  <span><span>(<span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
    <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
    <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span>)</span>
    lazy_t</span></span></code></div><div class="spec-doc"><p>objc_msgSend - the core Objective-C message dispatch</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-objc_msgSend"><a href="#val-objc_msgSend" class="anchor"></a><code><span><span class="keyword">val</span> objc_msgSend : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sel_registerName_lazy"><a href="#val-sel_registerName_lazy" class="anchor"></a><code><span><span class="keyword">val</span> sel_registerName_lazy : <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span>)</span> lazy_t</span></span></code></div><div class="spec-doc"><p>sel_registerName - register a selector</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sel_registerName"><a href="#val-sel_registerName" class="anchor"></a><code><span><span class="keyword">val</span> sel_registerName : <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-objc_getClass_lazy"><a href="#val-objc_getClass_lazy" class="anchor"></a><code><span><span class="keyword">val</span> objc_getClass_lazy : <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span>)</span> lazy_t</span></span></code></div><div class="spec-doc"><p>objc_getClass - get a class by name</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-objc_getClass"><a href="#val-objc_getClass" class="anchor"></a><code><span><span class="keyword">val</span> objc_getClass : <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div></div><h2 id="foundation-helpers"><a href="#foundation-helpers" class="anchor"></a>Foundation Helpers</h2><div class="odoc-spec"><div class="spec value anchored" id="val-foundation_lib"><a href="#val-foundation_lib" class="anchor"></a><code><span><span class="keyword">val</span> foundation_lib : <span><span><span class="xref-unresolved">Dl</span>.library option</span> <span class="xref-unresolved">Stdlib</span>.Lazy.t</span></span></code></div><div class="spec-doc"><p>Load Foundation framework for NSString, NSArray, etc</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_foundation_lib"><a href="#val-get_foundation_lib" class="anchor"></a><code><span><span class="keyword">val</span> get_foundation_lib : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Dl</span>.library</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-nsstring_from_cstring"><a href="#val-nsstring_from_cstring" class="anchor"></a><code><span><span class="keyword">val</span> nsstring_from_cstring : <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div><div class="spec-doc"><p>Helper: Create NSString from C string</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cstring_from_nsstring"><a href="#val-cstring_from_nsstring" class="anchor"></a><code><span><span class="keyword">val</span> cstring_from_nsstring : <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Helper: Get C string from NSString</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-nserror_description"><a href="#val-nserror_description" class="anchor"></a><code><span><span class="keyword">val</span> nserror_description : <span><span>unit <span class="xref-unresolved">Ctypes</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Helper: Get NSError description</p></div></div><h2 id="metal-device-api"><a href="#metal-device-api" class="anchor"></a>Metal Device API</h2><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_create_system_default_device_lazy"><a href="#val-mtl_create_system_default_device_lazy" class="anchor"></a><code><span><span class="keyword">val</span> mtl_create_system_default_device_lazy : 
  <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <a href="../Metal_types/index.html#type-mtl_device">Metal_types.mtl_device</a>)</span> lazy_t</span></span></code></div><div class="spec-doc"><p>MTLCreateSystemDefaultDevice - get default GPU</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_create_system_default_device"><a href="#val-mtl_create_system_default_device" class="anchor"></a><code><span><span class="keyword">val</span> mtl_create_system_default_device : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="../Metal_types/index.html#type-mtl_device">Metal_types.mtl_device</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_copy_all_devices_lazy"><a href="#val-mtl_copy_all_devices_lazy" class="anchor"></a><code><span><span class="keyword">val</span> mtl_copy_all_devices_lazy : <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span>)</span> lazy_t</span></span></code></div><div class="spec-doc"><p>MTLCopyAllDevices - get all Metal devices</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_copy_all_devices"><a href="#val-mtl_copy_all_devices" class="anchor"></a><code><span><span class="keyword">val</span> mtl_copy_all_devices : <span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_device_name"><a href="#val-mtl_device_name" class="anchor"></a><code><span><span class="keyword">val</span> mtl_device_name : <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Device property getters via objc_msgSend</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_device_max_threads_per_threadgroup"><a href="#val-mtl_device_max_threads_per_threadgroup" class="anchor"></a><code><span><span class="keyword">val</span> mtl_device_max_threads_per_threadgroup : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Metal_types/index.html#type-mtl_size">Metal_types.mtl_size</a> <span class="xref-unresolved">Ctypes</span>.structure</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_device_max_threadgroup_memory_length"><a href="#val-mtl_device_max_threadgroup_memory_length" class="anchor"></a><code><span><span class="keyword">val</span> mtl_device_max_threadgroup_memory_length : <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><h2 id="command-queue-api"><a href="#command-queue-api" class="anchor"></a>Command Queue API</h2><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_device_new_command_queue"><a href="#val-mtl_device_new_command_queue" class="anchor"></a><code><span><span class="keyword">val</span> mtl_device_new_command_queue : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_command_queue_command_buffer"><a href="#val-mtl_command_queue_command_buffer" class="anchor"></a><code><span><span class="keyword">val</span> mtl_command_queue_command_buffer : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div></div><h2 id="command-buffer-api"><a href="#command-buffer-api" class="anchor"></a>Command Buffer API</h2><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_command_buffer_compute_command_encoder"><a href="#val-mtl_command_buffer_compute_command_encoder" class="anchor"></a><code><span><span class="keyword">val</span> mtl_command_buffer_compute_command_encoder : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_command_buffer_commit"><a href="#val-mtl_command_buffer_commit" class="anchor"></a><code><span><span class="keyword">val</span> mtl_command_buffer_commit : <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_command_buffer_wait_until_completed"><a href="#val-mtl_command_buffer_wait_until_completed" class="anchor"></a><code><span><span class="keyword">val</span> mtl_command_buffer_wait_until_completed : <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><h2 id="buffer-api"><a href="#buffer-api" class="anchor"></a>Buffer API</h2><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_device_new_buffer_with_length"><a href="#val-mtl_device_new_buffer_with_length" class="anchor"></a><code><span><span class="keyword">val</span> mtl_device_new_buffer_with_length : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="xref-unresolved">Unsigned</span>.uint64 <span class="arrow">&#45;&gt;</span></span>
  <a href="../Metal_types/index.html#type-mtl_buffer">Metal_types.mtl_buffer</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_buffer_contents"><a href="#val-mtl_buffer_contents" class="anchor"></a><code><span><span class="keyword">val</span> mtl_buffer_contents : <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_buffer_length"><a href="#val-mtl_buffer_length" class="anchor"></a><code><span><span class="keyword">val</span> mtl_buffer_length : <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><h2 id="library-api"><a href="#library-api" class="anchor"></a>Library API</h2><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_device_new_library_with_source"><a href="#val-mtl_device_new_library_with_source" class="anchor"></a><code><span><span class="keyword">val</span> mtl_device_new_library_with_source : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Metal_types/index.html#type-mtl_library">Metal_types.mtl_library</a>, string)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_library_new_function_with_name"><a href="#val-mtl_library_new_function_with_name" class="anchor"></a><code><span><span class="keyword">val</span> mtl_library_new_function_with_name : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string <span class="arrow">&#45;&gt;</span></span>
  <a href="../Metal_types/index.html#type-mtl_function">Metal_types.mtl_function</a></span></code></div></div><h2 id="compute-pipeline-api"><a href="#compute-pipeline-api" class="anchor"></a>Compute Pipeline API</h2><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_device_new_compute_pipeline_state"><a href="#val-mtl_device_new_compute_pipeline_state" class="anchor"></a><code><span><span class="keyword">val</span> mtl_device_new_compute_pipeline_state : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Metal_types/index.html#type-mtl_function">Metal_types.mtl_function</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<a href="../Metal_types/index.html#type-mtl_compute_pipeline_state">Metal_types.mtl_compute_pipeline_state</a>, string)</span> <span class="xref-unresolved">Stdlib</span>.result</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_compute_pipeline_state_max_total_threads_per_threadgroup"><a href="#val-mtl_compute_pipeline_state_max_total_threads_per_threadgroup" class="anchor"></a><code><span><span class="keyword">val</span> mtl_compute_pipeline_state_max_total_threads_per_threadgroup : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_compute_pipeline_state_threadgroup_memory_length"><a href="#val-mtl_compute_pipeline_state_threadgroup_memory_length" class="anchor"></a><code><span><span class="keyword">val</span> mtl_compute_pipeline_state_threadgroup_memory_length : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  int</span></code></div></div><h2 id="compute-command-encoder-api"><a href="#compute-command-encoder-api" class="anchor"></a>Compute Command Encoder API</h2><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_compute_command_encoder_set_compute_pipeline_state"><a href="#val-mtl_compute_command_encoder_set_compute_pipeline_state" class="anchor"></a><code><span><span class="keyword">val</span> mtl_compute_command_encoder_set_compute_pipeline_state : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Metal_types/index.html#type-mtl_compute_pipeline_state">Metal_types.mtl_compute_pipeline_state</a> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_compute_command_encoder_set_buffer"><a href="#val-mtl_compute_command_encoder_set_buffer" class="anchor"></a><code><span><span class="keyword">val</span> mtl_compute_command_encoder_set_buffer : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../Metal_types/index.html#type-mtl_buffer">Metal_types.mtl_buffer</a> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_compute_command_encoder_set_bytes"><a href="#val-mtl_compute_command_encoder_set_bytes" class="anchor"></a><code><span><span class="keyword">val</span> mtl_compute_command_encoder_set_bytes : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_compute_command_encoder_dispatch_threads"><a href="#val-mtl_compute_command_encoder_dispatch_threads" class="anchor"></a><code><span><span class="keyword">val</span> mtl_compute_command_encoder_dispatch_threads : 
  <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Metal_types/index.html#type-mtl_size">Metal_types.mtl_size</a> <span class="xref-unresolved">Ctypes</span>.structure</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><a href="../Metal_types/index.html#type-mtl_size">Metal_types.mtl_size</a> <span class="xref-unresolved">Ctypes</span>.structure</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mtl_compute_command_encoder_end_encoding"><a href="#val-mtl_compute_command_encoder_end_encoding" class="anchor"></a><code><span><span class="keyword">val</span> mtl_compute_command_encoder_end_encoding : <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><h2 id="memory-management"><a href="#memory-management" class="anchor"></a>Memory Management</h2><div class="odoc-spec"><div class="spec value anchored" id="val-release"><a href="#val-release" class="anchor"></a><code><span><span class="keyword">val</span> release : <span><span>unit <span class="xref-unresolved">Ctypes</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Release any NSObject/Metal object</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-retain"><a href="#val-retain" class="anchor"></a><code><span><span class="keyword">val</span> retain : <span><span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Ctypes_static</span>.ptr</span></span></code></div><div class="spec-doc"><p>Retain any NSObject/Metal object</p></div></div></div></body></html>
