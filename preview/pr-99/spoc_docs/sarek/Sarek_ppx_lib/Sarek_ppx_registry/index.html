<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Sarek_ppx_registry (sarek.Sarek_ppx_lib.Sarek_ppx_registry)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">sarek</a> &#x00BB; <a href="../index.html">Sarek_ppx_lib</a> &#x00BB; Sarek_ppx_registry</nav><header class="odoc-preamble"><h1>Module <code><span>Sarek_ppx_lib.Sarek_ppx_registry</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-type_info"><a href="#type-type_info" class="anchor"></a><code><span><span class="keyword">type</span> type_info</span><span> = </span><span>{</span></code><ol><li id="type-type_info.ti_name" class="def record field anchored"><a href="#type-type_info.ti_name" class="anchor"></a><code><span>ti_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Type name, e.g., &quot;float32&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-type_info.ti_device" class="def record field anchored"><a href="#type-type_info.ti_device" class="anchor"></a><code><span>ti_device : <span><a href="../../Spoc_core/Device/index.html#type-t">Spoc_core.Device.t</a> <span class="arrow">&#45;&gt;</span></span> string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Device type string, e.g., &quot;float&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-type_info.ti_size" class="def record field anchored"><a href="#type-type_info.ti_size" class="anchor"></a><code><span>ti_size : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Size in bytes</p><span class="comment-delim">*)</span></div></li><li id="type-type_info.ti_sarek_type" class="def record field anchored"><a href="#type-type_info.ti_sarek_type" class="anchor"></a><code><span>ti_sarek_type : <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Sarek type representation</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Type information for registered types (like float32, int64, etc.)</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-intrinsic_info"><a href="#type-intrinsic_info" class="anchor"></a><code><span><span class="keyword">type</span> intrinsic_info</span><span> = </span><span>{</span></code><ol><li id="type-intrinsic_info.ii_name" class="def record field anchored"><a href="#type-intrinsic_info.ii_name" class="anchor"></a><code><span>ii_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Function name, e.g., &quot;sin&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-intrinsic_info.ii_qualified_name" class="def record field anchored"><a href="#type-intrinsic_info.ii_qualified_name" class="anchor"></a><code><span>ii_qualified_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Qualified name, e.g., &quot;Float32.sin&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-intrinsic_info.ii_type" class="def record field anchored"><a href="#type-intrinsic_info.ii_type" class="anchor"></a><code><span>ii_type : <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Type signature</p><span class="comment-delim">*)</span></div></li><li id="type-intrinsic_info.ii_device" class="def record field anchored"><a href="#type-intrinsic_info.ii_device" class="anchor"></a><code><span>ii_device : <span><a href="../../Spoc_core/Device/index.html#type-t">Spoc_core.Device.t</a> <span class="arrow">&#45;&gt;</span></span> string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Device code generator - more generic than storing cuda/opencl separately</p><span class="comment-delim">*)</span></div></li><li id="type-intrinsic_info.ii_module" class="def record field anchored"><a href="#type-intrinsic_info.ii_module" class="anchor"></a><code><span>ii_module : <span>string list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Module path, e.g., <code>&quot;Sarek_stdlib&quot;; &quot;Float32&quot;</code></p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Intrinsic function information</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-const_info"><a href="#type-const_info" class="anchor"></a><code><span><span class="keyword">type</span> const_info</span><span> = </span><span>{</span></code><ol><li id="type-const_info.ci_name" class="def record field anchored"><a href="#type-const_info.ci_name" class="anchor"></a><code><span>ci_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Constant name</p><span class="comment-delim">*)</span></div></li><li id="type-const_info.ci_qualified_name" class="def record field anchored"><a href="#type-const_info.ci_qualified_name" class="anchor"></a><code><span>ci_qualified_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Qualified name</p><span class="comment-delim">*)</span></div></li><li id="type-const_info.ci_type" class="def record field anchored"><a href="#type-const_info.ci_type" class="anchor"></a><code><span>ci_type : <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Type</p><span class="comment-delim">*)</span></div></li><li id="type-const_info.ci_device" class="def record field anchored"><a href="#type-const_info.ci_device" class="anchor"></a><code><span>ci_device : <span><a href="../../Spoc_core/Device/index.html#type-t">Spoc_core.Device.t</a> <span class="arrow">&#45;&gt;</span></span> string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Device code generator</p><span class="comment-delim">*)</span></div></li><li id="type-const_info.ci_module" class="def record field anchored"><a href="#type-const_info.ci_module" class="anchor"></a><code><span>ci_module : <span>string list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Module path</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Intrinsic constant information (like thread_idx_x)</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-module_item_info"><a href="#type-module_item_info" class="anchor"></a><code><span><span class="keyword">type</span> module_item_info</span><span> = </span><span>{</span></code><ol><li id="type-module_item_info.mi_name" class="def record field anchored"><a href="#type-module_item_info.mi_name" class="anchor"></a><code><span>mi_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Function/constant name</p><span class="comment-delim">*)</span></div></li><li id="type-module_item_info.mi_qualified_name" class="def record field anchored"><a href="#type-module_item_info.mi_qualified_name" class="anchor"></a><code><span>mi_qualified_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Qualified name, e.g., &quot;Registered_defs.add_vec&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-module_item_info.mi_module" class="def record field anchored"><a href="#type-module_item_info.mi_module" class="anchor"></a><code><span>mi_module : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Module name, e.g., &quot;Registered_defs&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-module_item_info.mi_item" class="def record field anchored"><a href="#type-module_item_info.mi_item" class="anchor"></a><code><span>mi_item : <a href="../Sarek_ast/index.html#type-module_item">Sarek_ast.module_item</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The parsed AST item (MFun or MConst)</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Module item information for <code>@sarek.module</code> functions and constants. Unlike intrinsics, these are user-defined functions that get inlined into the generated GPU code.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-record_type_info"><a href="#type-record_type_info" class="anchor"></a><code><span><span class="keyword">type</span> record_type_info</span><span> = </span><span>{</span></code><ol><li id="type-record_type_info.rti_name" class="def record field anchored"><a href="#type-record_type_info.rti_name" class="anchor"></a><code><span>rti_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Type name</p><span class="comment-delim">*)</span></div></li><li id="type-record_type_info.rti_qualified_name" class="def record field anchored"><a href="#type-record_type_info.rti_qualified_name" class="anchor"></a><code><span>rti_qualified_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Qualified name</p><span class="comment-delim">*)</span></div></li><li id="type-record_type_info.rti_module" class="def record field anchored"><a href="#type-record_type_info.rti_module" class="anchor"></a><code><span>rti_module : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Module name</p><span class="comment-delim">*)</span></div></li><li id="type-record_type_info.rti_decl" class="def record field anchored"><a href="#type-record_type_info.rti_decl" class="anchor"></a><code><span>rti_decl : <a href="../Sarek_ast/index.html#type-type_decl">Sarek_ast.type_decl</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>The type declaration</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Record type information for <code>@sarek.type</code> records</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-types"><a href="#val-types" class="anchor"></a><code><span><span class="keyword">val</span> types : <span><span>(string, <a href="#type-type_info">type_info</a>)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div><div class="spec-doc"><p>The registries - populated at PPX load time</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-intrinsics"><a href="#val-intrinsics" class="anchor"></a><code><span><span class="keyword">val</span> intrinsics : <span><span>(string, <a href="#type-intrinsic_info">intrinsic_info</a>)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-consts"><a href="#val-consts" class="anchor"></a><code><span><span class="keyword">val</span> consts : <span><span>(string, <a href="#type-const_info">const_info</a>)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-module_items"><a href="#val-module_items" class="anchor"></a><code><span><span class="keyword">val</span> module_items : <span><span>(string, <a href="#type-module_item_info">module_item_info</a>)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-record_types"><a href="#val-record_types" class="anchor"></a><code><span><span class="keyword">val</span> record_types : <span><span>(string, <a href="#type-record_type_info">record_type_info</a>)</span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_type"><a href="#val-register_type" class="anchor"></a><code><span><span class="keyword">val</span> register_type : <span><a href="#type-type_info">type_info</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register a type</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_intrinsic"><a href="#val-register_intrinsic" class="anchor"></a><code><span><span class="keyword">val</span> register_intrinsic : <span><a href="#type-intrinsic_info">intrinsic_info</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register an intrinsic function</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_const"><a href="#val-register_const" class="anchor"></a><code><span><span class="keyword">val</span> register_const : <span><a href="#type-const_info">const_info</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register an intrinsic constant</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_module_item"><a href="#val-register_module_item" class="anchor"></a><code><span><span class="keyword">val</span> register_module_item : <span><a href="#type-module_item_info">module_item_info</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register a module item (<code>@sarek.module</code> function or constant)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-register_record_type"><a href="#val-register_record_type" class="anchor"></a><code><span><span class="keyword">val</span> register_record_type : <span><a href="#type-record_type_info">record_type_info</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register a record type (<code>@sarek.type</code>)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_type"><a href="#val-find_type" class="anchor"></a><code><span><span class="keyword">val</span> find_type : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-type_info">type_info</a> option</span></span></code></div><div class="spec-doc"><p>Find a type by name</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_intrinsic"><a href="#val-find_intrinsic" class="anchor"></a><code><span><span class="keyword">val</span> find_intrinsic : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-intrinsic_info">intrinsic_info</a> option</span></span></code></div><div class="spec-doc"><p>Find an intrinsic by name (short or qualified)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_const"><a href="#val-find_const" class="anchor"></a><code><span><span class="keyword">val</span> find_const : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-const_info">const_info</a> option</span></span></code></div><div class="spec-doc"><p>Find a constant by name (short or qualified)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_intrinsic"><a href="#val-is_intrinsic" class="anchor"></a><code><span><span class="keyword">val</span> is_intrinsic : <span>string <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check if a name is a registered intrinsic</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_const"><a href="#val-is_const" class="anchor"></a><code><span><span class="keyword">val</span> is_const : <span>string <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check if a name is a registered constant</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_module_item"><a href="#val-find_module_item" class="anchor"></a><code><span><span class="keyword">val</span> find_module_item : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-module_item_info">module_item_info</a> option</span></span></code></div><div class="spec-doc"><p>Find a module item by name (short or qualified)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_record_type"><a href="#val-find_record_type" class="anchor"></a><code><span><span class="keyword">val</span> find_record_type : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-record_type_info">record_type_info</a> option</span></span></code></div><div class="spec-doc"><p>Find a record type by name (short or qualified)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_module_item"><a href="#val-is_module_item" class="anchor"></a><code><span><span class="keyword">val</span> is_module_item : <span>string <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check if a name is a registered module item</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_record_type"><a href="#val-is_record_type" class="anchor"></a><code><span><span class="keyword">val</span> is_record_type : <span>string <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check if a name is a registered record type</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_types"><a href="#val-all_types" class="anchor"></a><code><span><span class="keyword">val</span> all_types : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-type_info">type_info</a> list</span></span></code></div><div class="spec-doc"><p>Get all registered types</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_intrinsics"><a href="#val-all_intrinsics" class="anchor"></a><code><span><span class="keyword">val</span> all_intrinsics : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-intrinsic_info">intrinsic_info</a> list</span></span></code></div><div class="spec-doc"><p>Get all registered intrinsics</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_consts"><a href="#val-all_consts" class="anchor"></a><code><span><span class="keyword">val</span> all_consts : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-const_info">const_info</a> list</span></span></code></div><div class="spec-doc"><p>Get all registered constants</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_module_items"><a href="#val-all_module_items" class="anchor"></a><code><span><span class="keyword">val</span> all_module_items : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-module_item_info">module_item_info</a> list</span></span></code></div><div class="spec-doc"><p>Get all registered module items</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-all_record_types"><a href="#val-all_record_types" class="anchor"></a><code><span><span class="keyword">val</span> all_record_types : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-record_type_info">record_type_info</a> list</span></span></code></div><div class="spec-doc"><p>Get all registered record types</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_type_info"><a href="#val-make_type_info" class="anchor"></a><code><span><span class="keyword">val</span> make_type_info : 
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">device</span>:<span>(<span><a href="../../Spoc_core/Device/index.html#type-t">Spoc_core.Device.t</a> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">size</span>:int <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">sarek_type</span>:<a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-type_info">type_info</a></span></code></div><div class="spec-doc"><p>Helper: create type_info for a numeric type</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_intrinsic_info"><a href="#val-make_intrinsic_info" class="anchor"></a><code><span><span class="keyword">val</span> make_intrinsic_info : 
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">module_path</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">typ</span>:<a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">device</span>:<span>(<span><a href="../../Spoc_core/Device/index.html#type-t">Spoc_core.Device.t</a> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-intrinsic_info">intrinsic_info</a></span></code></div><div class="spec-doc"><p>Helper: create intrinsic_info</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_const_info"><a href="#val-make_const_info" class="anchor"></a><code><span><span class="keyword">val</span> make_const_info : 
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">module_path</span>:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">typ</span>:<a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">device</span>:<span>(<span><a href="../../Spoc_core/Device/index.html#type-t">Spoc_core.Device.t</a> <span class="arrow">&#45;&gt;</span></span> string)</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-const_info">const_info</a></span></code></div><div class="spec-doc"><p>Helper: create const_info</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_module_item_info"><a href="#val-make_module_item_info" class="anchor"></a><code><span><span class="keyword">val</span> make_module_item_info : 
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">module_name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">item</span>:<a href="../Sarek_ast/index.html#type-module_item">Sarek_ast.module_item</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-module_item_info">module_item_info</a></span></code></div><div class="spec-doc"><p>Helper: create module_item_info</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-make_record_type_info"><a href="#val-make_record_type_info" class="anchor"></a><code><span><span class="keyword">val</span> make_record_type_info : 
  <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">module_name</span>:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="label">decl</span>:<a href="../Sarek_ast/index.html#type-type_decl">Sarek_ast.type_decl</a> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-record_type_info">record_type_info</a></span></code></div><div class="spec-doc"><p>Helper: create record_type_info</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-debug_print"><a href="#val-debug_print" class="anchor"></a><code><span><span class="keyword">val</span> debug_print : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Debug: print registered items</p></div></div></div></body></html>
