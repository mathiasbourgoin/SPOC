<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Framework_sig (spoc.Spoc_framework.Framework_sig)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">spoc</a> &#x00BB; <a href="../index.html">Spoc_framework</a> &#x00BB; Framework_sig</nav><header class="odoc-preamble"><h1>Module <code><span>Spoc_framework.Framework_sig</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#common-types">Common Types</a></li><li><a href="#plugin-module-signature">Plugin Module Signature</a></li></ul></nav></div><div class="odoc-content"><h2 id="common-types"><a href="#common-types" class="anchor"></a>Common Types</h2><div class="odoc-spec"><div class="spec type anchored" id="type-dims"><a href="#type-dims" class="anchor"></a><code><span><span class="keyword">type</span> dims</span><span> = </span><span>{</span></code><ol><li id="type-dims.x" class="def record field anchored"><a href="#type-dims.x" class="anchor"></a><code><span>x : int;</span></code></li><li id="type-dims.y" class="def record field anchored"><a href="#type-dims.y" class="anchor"></a><code><span>y : int;</span></code></li><li id="type-dims.z" class="def record field anchored"><a href="#type-dims.z" class="anchor"></a><code><span>z : int;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>3D dimensions for grid and block</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dims_1d"><a href="#val-dims_1d" class="anchor"></a><code><span><span class="keyword">val</span> dims_1d : <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-dims">dims</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dims_2d"><a href="#val-dims_2d" class="anchor"></a><code><span><span class="keyword">val</span> dims_2d : <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-dims">dims</a></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-dims_3d"><a href="#val-dims_3d" class="anchor"></a><code><span><span class="keyword">val</span> dims_3d : <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-dims">dims</a></span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-capabilities"><a href="#type-capabilities" class="anchor"></a><code><span><span class="keyword">type</span> capabilities</span><span> = </span><span>{</span></code><ol><li id="type-capabilities.max_threads_per_block" class="def record field anchored"><a href="#type-capabilities.max_threads_per_block" class="anchor"></a><code><span>max_threads_per_block : int;</span></code></li><li id="type-capabilities.max_block_dims" class="def record field anchored"><a href="#type-capabilities.max_block_dims" class="anchor"></a><code><span>max_block_dims : int * int * int;</span></code></li><li id="type-capabilities.max_grid_dims" class="def record field anchored"><a href="#type-capabilities.max_grid_dims" class="anchor"></a><code><span>max_grid_dims : int * int * int;</span></code></li><li id="type-capabilities.shared_mem_per_block" class="def record field anchored"><a href="#type-capabilities.shared_mem_per_block" class="anchor"></a><code><span>shared_mem_per_block : int;</span></code></li><li id="type-capabilities.total_global_mem" class="def record field anchored"><a href="#type-capabilities.total_global_mem" class="anchor"></a><code><span>total_global_mem : int64;</span></code></li><li id="type-capabilities.compute_capability" class="def record field anchored"><a href="#type-capabilities.compute_capability" class="anchor"></a><code><span>compute_capability : int * int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>(major, minor) for CUDA, (0,0) for OpenCL</p><span class="comment-delim">*)</span></div></li><li id="type-capabilities.supports_fp64" class="def record field anchored"><a href="#type-capabilities.supports_fp64" class="anchor"></a><code><span>supports_fp64 : bool;</span></code></li><li id="type-capabilities.supports_atomics" class="def record field anchored"><a href="#type-capabilities.supports_atomics" class="anchor"></a><code><span>supports_atomics : bool;</span></code></li><li id="type-capabilities.warp_size" class="def record field anchored"><a href="#type-capabilities.warp_size" class="anchor"></a><code><span>warp_size : int;</span></code></li><li id="type-capabilities.max_registers_per_block" class="def record field anchored"><a href="#type-capabilities.max_registers_per_block" class="anchor"></a><code><span>max_registers_per_block : int;</span></code></li><li id="type-capabilities.clock_rate_khz" class="def record field anchored"><a href="#type-capabilities.clock_rate_khz" class="anchor"></a><code><span>clock_rate_khz : int;</span></code></li><li id="type-capabilities.multiprocessor_count" class="def record field anchored"><a href="#type-capabilities.multiprocessor_count" class="anchor"></a><code><span>multiprocessor_count : int;</span></code></li><li id="type-capabilities.is_cpu" class="def record field anchored"><a href="#type-capabilities.is_cpu" class="anchor"></a><code><span>is_cpu : bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>True for CPU devices - enables zero-copy optimization</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Device capabilities - queried from hardware</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-device"><a href="#type-device" class="anchor"></a><code><span><span class="keyword">type</span> device</span><span> = </span><span>{</span></code><ol><li id="type-device.id" class="def record field anchored"><a href="#type-device.id" class="anchor"></a><code><span>id : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Global device ID (0, 1, 2...)</p><span class="comment-delim">*)</span></div></li><li id="type-device.backend_id" class="def record field anchored"><a href="#type-device.backend_id" class="anchor"></a><code><span>backend_id : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>ID within the backend (0, 1...)</p><span class="comment-delim">*)</span></div></li><li id="type-device.name" class="def record field anchored"><a href="#type-device.name" class="anchor"></a><code><span>name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Human-readable device name</p><span class="comment-delim">*)</span></div></li><li id="type-device.framework" class="def record field anchored"><a href="#type-device.framework" class="anchor"></a><code><span>framework : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Backend name: &quot;CUDA&quot;, &quot;OpenCL&quot;, &quot;Vulkan&quot;, &quot;Native&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-device.capabilities" class="def record field anchored"><a href="#type-device.capabilities" class="anchor"></a><code><span>capabilities : <a href="#type-capabilities">capabilities</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Device representation - SDK layer type shared across all backends</p></div></div><h2 id="plugin-module-signature"><a href="#plugin-module-signature" class="anchor"></a>Plugin Module Signature</h2><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-S"><a href="#module-type-S" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-S/index.html">S</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Minimal framework signature for plugin registration. Used by Framework_registry for basic plugin management.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-execution_model"><a href="#type-execution_model" class="anchor"></a><code><span><span class="keyword">type</span> execution_model</span><span> = </span></code><ol><li id="type-execution_model.JIT" class="def variant constructor anchored"><a href="#type-execution_model.JIT" class="anchor"></a><code><span>| </span><span><span class="constructor">JIT</span></span></code></li><li id="type-execution_model.Direct" class="def variant constructor anchored"><a href="#type-execution_model.Direct" class="anchor"></a><code><span>| </span><span><span class="constructor">Direct</span></span></code></li><li id="type-execution_model.Custom" class="def variant constructor anchored"><a href="#type-execution_model.Custom" class="anchor"></a><code><span>| </span><span><span class="constructor">Custom</span></span></code></li></ol></div><div class="spec-doc"><p>Execution model for backends.</p><ul><li>JIT: Generate source code at runtime, compile with GPU compiler (CUDA, OpenCL)</li><li>Direct: Execute pre-compiled OCaml functions directly (Native CPU)</li><li>Custom: Full control over compilation pipeline (LLVM, SPIR-V, future)</li></ul></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-source_lang"><a href="#type-source_lang" class="anchor"></a><code><span><span class="keyword">type</span> source_lang</span><span> = </span></code><ol><li id="type-source_lang.CUDA_Source" class="def variant constructor anchored"><a href="#type-source_lang.CUDA_Source" class="anchor"></a><code><span>| </span><span><span class="constructor">CUDA_Source</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>CUDA C/C++ source (.cu)</p><span class="comment-delim">*)</span></div></li><li id="type-source_lang.OpenCL_Source" class="def variant constructor anchored"><a href="#type-source_lang.OpenCL_Source" class="anchor"></a><code><span>| </span><span><span class="constructor">OpenCL_Source</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>OpenCL C source (.cl)</p><span class="comment-delim">*)</span></div></li><li id="type-source_lang.PTX" class="def variant constructor anchored"><a href="#type-source_lang.PTX" class="anchor"></a><code><span>| </span><span><span class="constructor">PTX</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>NVIDIA PTX assembly</p><span class="comment-delim">*)</span></div></li><li id="type-source_lang.SPIR_V" class="def variant constructor anchored"><a href="#type-source_lang.SPIR_V" class="anchor"></a><code><span>| </span><span><span class="constructor">SPIR_V</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>SPIR-V binary</p><span class="comment-delim">*)</span></div></li><li id="type-source_lang.GLSL_Source" class="def variant constructor anchored"><a href="#type-source_lang.GLSL_Source" class="anchor"></a><code><span>| </span><span><span class="constructor">GLSL_Source</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Vulkan GLSL compute shader</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Source language for external kernels</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-kargs"><a href="#type-kargs" class="anchor"></a><code><span><span class="keyword">type</span> kargs</span><span> = </span><span>..</span></code></div><div class="spec-doc"><p>Extensible type for backend-specific kernel arguments. Each backend extends this type with its own variant. This allows type-safe passing of kernel args across the framework boundary without Obj.t.</p></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-No_kargs"><a href="#extension-decl-No_kargs" class="anchor"></a><code><span><span class="keyword">type</span> <a href="#type-kargs">kargs</a> += </span></code><ol><li id="extension-No_kargs" class="def variant extension anchored"><a href="#extension-No_kargs" class="anchor"></a><code><span>| </span><span><span class="extension">No_kargs</span></span></code></li></ol></div><div class="spec-doc"><p>Placeholder kargs for testing - not associated with any backend</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-run_source_arg"><a href="#type-run_source_arg" class="anchor"></a><code><span><span class="keyword">type</span> run_source_arg</span><span> = </span></code><ol><li id="type-run_source_arg.RSA_Buffer" class="def variant constructor anchored"><a href="#type-run_source_arg.RSA_Buffer" class="anchor"></a><code><span>| </span><span><span class="constructor">RSA_Buffer</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-run_source_arg.binder" class="def record field anchored"><a href="#type-run_source_arg.binder" class="anchor"></a><code><span>binder : <span><a href="#type-kargs">kargs</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> unit;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Binds buffer to kernel arg</p><span class="comment-delim">*)</span></div></li><li id="type-run_source_arg.length" class="def record field anchored"><a href="#type-run_source_arg.length" class="anchor"></a><code><span>length : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Vector length for generated kernels</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></li><li id="type-run_source_arg.RSA_Int32" class="def variant constructor anchored"><a href="#type-run_source_arg.RSA_Int32" class="anchor"></a><code><span>| </span><span><span class="constructor">RSA_Int32</span> <span class="keyword">of</span> int32</span></code></li><li id="type-run_source_arg.RSA_Int64" class="def variant constructor anchored"><a href="#type-run_source_arg.RSA_Int64" class="anchor"></a><code><span>| </span><span><span class="constructor">RSA_Int64</span> <span class="keyword">of</span> int64</span></code></li><li id="type-run_source_arg.RSA_Float32" class="def variant constructor anchored"><a href="#type-run_source_arg.RSA_Float32" class="anchor"></a><code><span>| </span><span><span class="constructor">RSA_Float32</span> <span class="keyword">of</span> float</span></code></li><li id="type-run_source_arg.RSA_Float64" class="def variant constructor anchored"><a href="#type-run_source_arg.RSA_Float64" class="anchor"></a><code><span>| </span><span><span class="constructor">RSA_Float64</span> <span class="keyword">of</span> float</span></code></li></ol></div><div class="spec-doc"><p>Argument type for run_source. Buffer binder receives typed kargs.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-convergence"><a href="#type-convergence" class="anchor"></a><code><span><span class="keyword">type</span> convergence</span><span> = </span></code><ol><li id="type-convergence.Uniform" class="def variant constructor anchored"><a href="#type-convergence.Uniform" class="anchor"></a><code><span>| </span><span><span class="constructor">Uniform</span></span></code></li><li id="type-convergence.Divergent" class="def variant constructor anchored"><a href="#type-convergence.Divergent" class="anchor"></a><code><span>| </span><span><span class="constructor">Divergent</span></span></code></li><li id="type-convergence.Sync" class="def variant constructor anchored"><a href="#type-convergence.Sync" class="anchor"></a><code><span>| </span><span><span class="constructor">Sync</span></span></code></li></ol></div><div class="spec-doc"><p>Convergence behavior of an intrinsic.</p><ul><li>Uniform: All threads in warp/wavefront compute same value</li><li>Divergent: Threads may compute different values</li><li>Sync: Intrinsic contains synchronization (barrier)</li></ul></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-INTRINSIC_REGISTRY"><a href="#module-type-INTRINSIC_REGISTRY" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-INTRINSIC_REGISTRY/index.html">INTRINSIC_REGISTRY</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Intrinsic registry interface for backend-specific intrinsics. Note: The actual intrinsic_impl type is defined in each backend's intrinsic registry module to avoid circular dependencies with Sarek_ir.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-exec_arg"><a href="#type-exec_arg" class="anchor"></a><code><span><span class="keyword">type</span> exec_arg</span><span> = <a href="../Typed_value/index.html#type-exec_arg">Typed_value.exec_arg</a></span><span> = </span></code><ol><li id="type-exec_arg.EA_Int32" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Int32" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Int32</span> <span class="keyword">of</span> int32</span></code></li><li id="type-exec_arg.EA_Int64" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Int64" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Int64</span> <span class="keyword">of</span> int64</span></code></li><li id="type-exec_arg.EA_Float32" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Float32" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Float32</span> <span class="keyword">of</span> float</span></code></li><li id="type-exec_arg.EA_Float64" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Float64" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Float64</span> <span class="keyword">of</span> float</span></code></li><li id="type-exec_arg.EA_Scalar" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Scalar" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Scalar</span> : <span>(<span class="keyword">module</span> <a href="../Typed_value/module-type-SCALAR_TYPE/index.html">Typed_value.SCALAR_TYPE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../Typed_value/module-type-SCALAR_TYPE/index.html#type-t">t</a> = <span class="type-var">'a</span>)</span> * <span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span> <a href="#type-exec_arg">exec_arg</a></span></code></li><li id="type-exec_arg.EA_Composite" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Composite" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Composite</span> : <span>(<span class="keyword">module</span> <a href="../Typed_value/module-type-COMPOSITE_TYPE/index.html">Typed_value.COMPOSITE_TYPE</a>
  <span class="keyword">with</span> <span class="keyword">type</span> <a href="../Typed_value/module-type-COMPOSITE_TYPE/index.html#type-t">t</a> = <span class="type-var">'a</span>)</span>
  * <span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span> <a href="#type-exec_arg">exec_arg</a></span></code></li><li id="type-exec_arg.EA_Vec" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Vec" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Vec</span> <span class="keyword">of</span> <span>(<span class="keyword">module</span> <a href="../Typed_value/module-type-EXEC_VECTOR/index.html">Typed_value.EXEC_VECTOR</a>)</span></span></code></li></ol></div><div class="spec-doc"><p>Re-export typed value types for convenience</p></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-BACKEND"><a href="#module-type-BACKEND" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-BACKEND/index.html">BACKEND</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Extended backend signature for Phase 4 unified execution. Adds execution model discrimination and IR-based code generation.</p></div></div></div></body></html>
