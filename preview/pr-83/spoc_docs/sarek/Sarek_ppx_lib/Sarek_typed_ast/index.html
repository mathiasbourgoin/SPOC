<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Sarek_typed_ast (sarek.Sarek_ppx_lib.Sarek_typed_ast)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">sarek</a> &#x00BB; <a href="../index.html">Sarek_ppx_lib</a> &#x00BB; Sarek_typed_ast</nav><header class="odoc-preamble"><h1>Module <code><span>Sarek_ppx_lib.Sarek_typed_ast</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-tparam"><a href="#type-tparam" class="anchor"></a><code><span><span class="keyword">type</span> tparam</span><span> = </span><span>{</span></code><ol><li id="type-tparam.tparam_name" class="def record field anchored"><a href="#type-tparam.tparam_name" class="anchor"></a><code><span>tparam_name : string;</span></code></li><li id="type-tparam.tparam_type" class="def record field anchored"><a href="#type-tparam.tparam_type" class="anchor"></a><code><span>tparam_type : <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a>;</span></code></li><li id="type-tparam.tparam_index" class="def record field anchored"><a href="#type-tparam.tparam_index" class="anchor"></a><code><span>tparam_index : int;</span></code></li><li id="type-tparam.tparam_is_vec" class="def record field anchored"><a href="#type-tparam.tparam_is_vec" class="anchor"></a><code><span>tparam_is_vec : bool;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Is this a vector parameter?</p><span class="comment-delim">*)</span></div></li><li id="type-tparam.tparam_id" class="def record field anchored"><a href="#type-tparam.tparam_id" class="anchor"></a><code><span>tparam_id : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Variable ID for this parameter</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Typed kernel parameter - defined before texpr so TELetRec can reference it</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-texpr"><a href="#type-texpr" class="anchor"></a><code><span><span class="keyword">type</span> texpr</span><span> = </span><span>{</span></code><ol><li id="type-texpr.te" class="def record field anchored"><a href="#type-texpr.te" class="anchor"></a><code><span>te : <a href="#type-texpr_desc">texpr_desc</a>;</span></code></li><li id="type-texpr.ty" class="def record field anchored"><a href="#type-texpr.ty" class="anchor"></a><code><span>ty : <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Always resolved, never contains unbound TVar</p><span class="comment-delim">*)</span></div></li><li id="type-texpr.te_loc" class="def record field anchored"><a href="#type-texpr.te_loc" class="anchor"></a><code><span>te_loc : <a href="../Sarek_ast/index.html#type-loc">Sarek_ast.loc</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Typed expression - every node has its type</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-texpr_desc"><a href="#type-texpr_desc" class="anchor"></a><code><span><span class="keyword">and</span> texpr_desc</span><span> = </span></code><ol><li id="type-texpr_desc.TEUnit" class="def variant constructor anchored"><a href="#type-texpr_desc.TEUnit" class="anchor"></a><code><span>| </span><span><span class="constructor">TEUnit</span></span></code></li><li id="type-texpr_desc.TEBool" class="def variant constructor anchored"><a href="#type-texpr_desc.TEBool" class="anchor"></a><code><span>| </span><span><span class="constructor">TEBool</span> <span class="keyword">of</span> bool</span></code></li><li id="type-texpr_desc.TEInt" class="def variant constructor anchored"><a href="#type-texpr_desc.TEInt" class="anchor"></a><code><span>| </span><span><span class="constructor">TEInt</span> <span class="keyword">of</span> int</span></code></li><li id="type-texpr_desc.TEInt32" class="def variant constructor anchored"><a href="#type-texpr_desc.TEInt32" class="anchor"></a><code><span>| </span><span><span class="constructor">TEInt32</span> <span class="keyword">of</span> int32</span></code></li><li id="type-texpr_desc.TEInt64" class="def variant constructor anchored"><a href="#type-texpr_desc.TEInt64" class="anchor"></a><code><span>| </span><span><span class="constructor">TEInt64</span> <span class="keyword">of</span> int64</span></code></li><li id="type-texpr_desc.TEFloat" class="def variant constructor anchored"><a href="#type-texpr_desc.TEFloat" class="anchor"></a><code><span>| </span><span><span class="constructor">TEFloat</span> <span class="keyword">of</span> float</span></code></li><li id="type-texpr_desc.TEDouble" class="def variant constructor anchored"><a href="#type-texpr_desc.TEDouble" class="anchor"></a><code><span>| </span><span><span class="constructor">TEDouble</span> <span class="keyword">of</span> float</span></code></li><li id="type-texpr_desc.TEVar" class="def variant constructor anchored"><a href="#type-texpr_desc.TEVar" class="anchor"></a><code><span>| </span><span><span class="constructor">TEVar</span> <span class="keyword">of</span> string * int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>name, variable id</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TEVecGet" class="def variant constructor anchored"><a href="#type-texpr_desc.TEVecGet" class="anchor"></a><code><span>| </span><span><span class="constructor">TEVecGet</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TEVecSet" class="def variant constructor anchored"><a href="#type-texpr_desc.TEVecSet" class="anchor"></a><code><span>| </span><span><span class="constructor">TEVecSet</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TEArrGet" class="def variant constructor anchored"><a href="#type-texpr_desc.TEArrGet" class="anchor"></a><code><span>| </span><span><span class="constructor">TEArrGet</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TEArrSet" class="def variant constructor anchored"><a href="#type-texpr_desc.TEArrSet" class="anchor"></a><code><span>| </span><span><span class="constructor">TEArrSet</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TEFieldGet" class="def variant constructor anchored"><a href="#type-texpr_desc.TEFieldGet" class="anchor"></a><code><span>| </span><span><span class="constructor">TEFieldGet</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * string * int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>expr, field name, field index</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TEFieldSet" class="def variant constructor anchored"><a href="#type-texpr_desc.TEFieldSet" class="anchor"></a><code><span>| </span><span><span class="constructor">TEFieldSet</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * string * int * <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TEBinop" class="def variant constructor anchored"><a href="#type-texpr_desc.TEBinop" class="anchor"></a><code><span>| </span><span><span class="constructor">TEBinop</span> <span class="keyword">of</span> <a href="../Sarek_ast/index.html#type-binop">Sarek_ast.binop</a> * <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TEUnop" class="def variant constructor anchored"><a href="#type-texpr_desc.TEUnop" class="anchor"></a><code><span>| </span><span><span class="constructor">TEUnop</span> <span class="keyword">of</span> <a href="../Sarek_ast/index.html#type-unop">Sarek_ast.unop</a> * <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TEApp" class="def variant constructor anchored"><a href="#type-texpr_desc.TEApp" class="anchor"></a><code><span>| </span><span><span class="constructor">TEApp</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * <span><a href="#type-texpr">texpr</a> list</span></span></code></li><li id="type-texpr_desc.TEAssign" class="def variant constructor anchored"><a href="#type-texpr_desc.TEAssign" class="anchor"></a><code><span>| </span><span><span class="constructor">TEAssign</span> <span class="keyword">of</span> string * int * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>name, var_id, value</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TELet" class="def variant constructor anchored"><a href="#type-texpr_desc.TELet" class="anchor"></a><code><span>| </span><span><span class="constructor">TELet</span> <span class="keyword">of</span> string * int * <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>name, var_id, value, body</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TELetRec" class="def variant constructor anchored"><a href="#type-texpr_desc.TELetRec" class="anchor"></a><code><span>| </span><span><span class="constructor">TELetRec</span> <span class="keyword">of</span> string * int * <span><a href="#type-tparam">tparam</a> list</span> * <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>name, fn_id, params, fn_body, continuation</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TELetMut" class="def variant constructor anchored"><a href="#type-texpr_desc.TELetMut" class="anchor"></a><code><span>| </span><span><span class="constructor">TELetMut</span> <span class="keyword">of</span> string * int * <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TEIf" class="def variant constructor anchored"><a href="#type-texpr_desc.TEIf" class="anchor"></a><code><span>| </span><span><span class="constructor">TEIf</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a> * <span><a href="#type-texpr">texpr</a> option</span></span></code></li><li id="type-texpr_desc.TEFor" class="def variant constructor anchored"><a href="#type-texpr_desc.TEFor" class="anchor"></a><code><span>| </span><span><span class="constructor">TEFor</span> <span class="keyword">of</span> string * int * <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a> * <a href="../Sarek_ast/index.html#type-for_dir">Sarek_ast.for_dir</a> * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>var, id, lo, hi, dir, body</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TEWhile" class="def variant constructor anchored"><a href="#type-texpr_desc.TEWhile" class="anchor"></a><code><span>| </span><span><span class="constructor">TEWhile</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TESeq" class="def variant constructor anchored"><a href="#type-texpr_desc.TESeq" class="anchor"></a><code><span>| </span><span><span class="constructor">TESeq</span> <span class="keyword">of</span> <span><a href="#type-texpr">texpr</a> list</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Flattened sequence</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TEMatch" class="def variant constructor anchored"><a href="#type-texpr_desc.TEMatch" class="anchor"></a><code><span>| </span><span><span class="constructor">TEMatch</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * <span><span>(<a href="#type-tpattern">tpattern</a> * <a href="#type-texpr">texpr</a>)</span> list</span></span></code></li><li id="type-texpr_desc.TERecord" class="def variant constructor anchored"><a href="#type-texpr_desc.TERecord" class="anchor"></a><code><span>| </span><span><span class="constructor">TERecord</span> <span class="keyword">of</span> string * <span><span>(string * <a href="#type-texpr">texpr</a>)</span> list</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>type_name, fields</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TEConstr" class="def variant constructor anchored"><a href="#type-texpr_desc.TEConstr" class="anchor"></a><code><span>| </span><span><span class="constructor">TEConstr</span> <span class="keyword">of</span> string * string * <span><a href="#type-texpr">texpr</a> option</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>type_name, constr_name, arg</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TETuple" class="def variant constructor anchored"><a href="#type-texpr_desc.TETuple" class="anchor"></a><code><span>| </span><span><span class="constructor">TETuple</span> <span class="keyword">of</span> <span><a href="#type-texpr">texpr</a> list</span></span></code></li><li id="type-texpr_desc.TEReturn" class="def variant constructor anchored"><a href="#type-texpr_desc.TEReturn" class="anchor"></a><code><span>| </span><span><span class="constructor">TEReturn</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a></span></code></li><li id="type-texpr_desc.TECreateArray" class="def variant constructor anchored"><a href="#type-texpr_desc.TECreateArray" class="anchor"></a><code><span>| </span><span><span class="constructor">TECreateArray</span> <span class="keyword">of</span> <a href="#type-texpr">texpr</a> * <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> * <a href="../Sarek_types/index.html#type-memspace">Sarek_types.memspace</a></span></code></li><li id="type-texpr_desc.TEGlobalRef" class="def variant constructor anchored"><a href="#type-texpr_desc.TEGlobalRef" class="anchor"></a><code><span>| </span><span><span class="constructor">TEGlobalRef</span> <span class="keyword">of</span> string * <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>External ref with its type</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TENative" class="def variant constructor anchored"><a href="#type-texpr_desc.TENative" class="anchor"></a><code><span>| </span><span><span class="constructor">TENative</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-texpr_desc.gpu" class="def record field anchored"><a href="#type-texpr_desc.gpu" class="anchor"></a><code><span>gpu : <span class="xref-unresolved">Ppxlib</span>.expression;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>fun dev -&gt; &quot;cuda/opencl code&quot;</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.ocaml" class="def record field anchored"><a href="#type-texpr_desc.ocaml" class="anchor"></a><code><span>ocaml : <span class="xref-unresolved">Ppxlib</span>.expression;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>OCaml fallback for interpreter/native</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Native code with GPU and OCaml expressions</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TEPragma" class="def variant constructor anchored"><a href="#type-texpr_desc.TEPragma" class="anchor"></a><code><span>| </span><span><span class="constructor">TEPragma</span> <span class="keyword">of</span> <span>string list</span> * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>pragma options body</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TEIntrinsicConst" class="def variant constructor anchored"><a href="#type-texpr_desc.TEIntrinsicConst" class="anchor"></a><code><span>| </span><span><span class="constructor">TEIntrinsicConst</span> <span class="keyword">of</span> <a href="../Sarek_env/index.html#type-intrinsic_ref">Sarek_env.intrinsic_ref</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Reference to intrinsic constant</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TEIntrinsicFun" class="def variant constructor anchored"><a href="#type-texpr_desc.TEIntrinsicFun" class="anchor"></a><code><span>| </span><span><span class="constructor">TEIntrinsicFun</span> <span class="keyword">of</span> <a href="../Sarek_env/index.html#type-intrinsic_ref">Sarek_env.intrinsic_ref</a>
  * <span><a href="../Sarek_core_primitives/index.html#type-convergence">Sarek_core_primitives.convergence</a> option</span>
  * <span><a href="#type-texpr">texpr</a> list</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Reference to intrinsic function, convergence requirement, args</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TELetShared" class="def variant constructor anchored"><a href="#type-texpr_desc.TELetShared" class="anchor"></a><code><span>| </span><span><span class="constructor">TELetShared</span> <span class="keyword">of</span> string * int * <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> * <span><a href="#type-texpr">texpr</a> option</span> * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>name, var_id, elem_type, size_opt, body</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TESuperstep" class="def variant constructor anchored"><a href="#type-texpr_desc.TESuperstep" class="anchor"></a><code><span>| </span><span><span class="constructor">TESuperstep</span> <span class="keyword">of</span> string * bool * <a href="#type-texpr">texpr</a> * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>name, divergent, body, continuation</p><span class="comment-delim">*)</span></div></li><li id="type-texpr_desc.TEOpen" class="def variant constructor anchored"><a href="#type-texpr_desc.TEOpen" class="anchor"></a><code><span>| </span><span><span class="constructor">TEOpen</span> <span class="keyword">of</span> <span>string list</span> * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>let open M.N in e</p><span class="comment-delim">*)</span></div></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-tpattern"><a href="#type-tpattern" class="anchor"></a><code><span><span class="keyword">and</span> tpattern</span><span> = </span><span>{</span></code><ol><li id="type-tpattern.tpat" class="def record field anchored"><a href="#type-tpattern.tpat" class="anchor"></a><code><span>tpat : <a href="#type-tpattern_desc">tpattern_desc</a>;</span></code></li><li id="type-tpattern.tpat_ty" class="def record field anchored"><a href="#type-tpattern.tpat_ty" class="anchor"></a><code><span>tpat_ty : <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a>;</span></code></li><li id="type-tpattern.tpat_loc" class="def record field anchored"><a href="#type-tpattern.tpat_loc" class="anchor"></a><code><span>tpat_loc : <a href="../Sarek_ast/index.html#type-loc">Sarek_ast.loc</a>;</span></code></li></ol><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-tpattern_desc"><a href="#type-tpattern_desc" class="anchor"></a><code><span><span class="keyword">and</span> tpattern_desc</span><span> = </span></code><ol><li id="type-tpattern_desc.TPAny" class="def variant constructor anchored"><a href="#type-tpattern_desc.TPAny" class="anchor"></a><code><span>| </span><span><span class="constructor">TPAny</span></span></code></li><li id="type-tpattern_desc.TPVar" class="def variant constructor anchored"><a href="#type-tpattern_desc.TPVar" class="anchor"></a><code><span>| </span><span><span class="constructor">TPVar</span> <span class="keyword">of</span> string * int</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>name, var_id</p><span class="comment-delim">*)</span></div></li><li id="type-tpattern_desc.TPConstr" class="def variant constructor anchored"><a href="#type-tpattern_desc.TPConstr" class="anchor"></a><code><span>| </span><span><span class="constructor">TPConstr</span> <span class="keyword">of</span> string * string * <span><a href="#type-tpattern">tpattern</a> option</span></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>type_name, constr, arg</p><span class="comment-delim">*)</span></div></li><li id="type-tpattern_desc.TPTuple" class="def variant constructor anchored"><a href="#type-tpattern_desc.TPTuple" class="anchor"></a><code><span>| </span><span><span class="constructor">TPTuple</span> <span class="keyword">of</span> <span><a href="#type-tpattern">tpattern</a> list</span></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-ttype_decl"><a href="#type-ttype_decl" class="anchor"></a><code><span><span class="keyword">type</span> ttype_decl</span><span> = </span></code><ol><li id="type-ttype_decl.TTypeRecord" class="def variant constructor anchored"><a href="#type-ttype_decl.TTypeRecord" class="anchor"></a><code><span>| </span><span><span class="constructor">TTypeRecord</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-ttype_decl.tdecl_name" class="def record field anchored"><a href="#type-ttype_decl.tdecl_name" class="anchor"></a><code><span>tdecl_name : string;</span></code></li><li id="type-ttype_decl.tdecl_module" class="def record field anchored"><a href="#type-ttype_decl.tdecl_module" class="anchor"></a><code><span>tdecl_module : <span>string option</span>;</span></code></li><li id="type-ttype_decl.tdecl_fields" class="def record field anchored"><a href="#type-ttype_decl.tdecl_fields" class="anchor"></a><code><span>tdecl_fields : <span><span>(string * <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> * bool)</span> list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>name, type, mutable</p><span class="comment-delim">*)</span></div></li><li id="type-ttype_decl.tdecl_loc" class="def record field anchored"><a href="#type-ttype_decl.tdecl_loc" class="anchor"></a><code><span>tdecl_loc : <a href="../Sarek_ast/index.html#type-loc">Sarek_ast.loc</a>;</span></code></li></ol><code><span>}</span></code></li><li id="type-ttype_decl.TTypeVariant" class="def variant constructor anchored"><a href="#type-ttype_decl.TTypeVariant" class="anchor"></a><code><span>| </span><span><span class="constructor">TTypeVariant</span> <span class="keyword">of</span> </span><span>{</span></code><ol><li id="type-ttype_decl.tdecl_name" class="def record field anchored"><a href="#type-ttype_decl.tdecl_name" class="anchor"></a><code><span>tdecl_name : string;</span></code></li><li id="type-ttype_decl.tdecl_module" class="def record field anchored"><a href="#type-ttype_decl.tdecl_module" class="anchor"></a><code><span>tdecl_module : <span>string option</span>;</span></code></li><li id="type-ttype_decl.tdecl_constructors" class="def record field anchored"><a href="#type-ttype_decl.tdecl_constructors" class="anchor"></a><code><span>tdecl_constructors : <span><span>(string * <span><a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> option</span>)</span> list</span>;</span></code></li><li id="type-ttype_decl.tdecl_loc" class="def record field anchored"><a href="#type-ttype_decl.tdecl_loc" class="anchor"></a><code><span>tdecl_loc : <a href="../Sarek_ast/index.html#type-loc">Sarek_ast.loc</a>;</span></code></li></ol><code><span>}</span></code></li></ol></div><div class="spec-doc"><p>Typed type declarations</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-tmodule_item"><a href="#type-tmodule_item" class="anchor"></a><code><span><span class="keyword">type</span> tmodule_item</span><span> = </span></code><ol><li id="type-tmodule_item.TMConst" class="def variant constructor anchored"><a href="#type-tmodule_item.TMConst" class="anchor"></a><code><span>| </span><span><span class="constructor">TMConst</span> <span class="keyword">of</span> string * int * <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>let name : ty = expr, var id</p><span class="comment-delim">*)</span></div></li><li id="type-tmodule_item.TMFun" class="def variant constructor anchored"><a href="#type-tmodule_item.TMFun" class="anchor"></a><code><span>| </span><span><span class="constructor">TMFun</span> <span class="keyword">of</span> string * bool * <span><a href="#type-tparam">tparam</a> list</span> * <a href="#type-texpr">texpr</a></span></code><div class="def-doc"><span class="comment-delim">(*</span><p>TMFun(name, is_recursive, params, body)</p><span class="comment-delim">*)</span></div></li></ol></div><div class="spec-doc"><p>Typed module item</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-tkernel"><a href="#type-tkernel" class="anchor"></a><code><span><span class="keyword">type</span> tkernel</span><span> = </span><span>{</span></code><ol><li id="type-tkernel.tkern_name" class="def record field anchored"><a href="#type-tkernel.tkern_name" class="anchor"></a><code><span>tkern_name : <span>string option</span>;</span></code></li><li id="type-tkernel.tkern_type_decls" class="def record field anchored"><a href="#type-tkernel.tkern_type_decls" class="anchor"></a><code><span>tkern_type_decls : <span><a href="#type-ttype_decl">ttype_decl</a> list</span>;</span></code></li><li id="type-tkernel.tkern_module_items" class="def record field anchored"><a href="#type-tkernel.tkern_module_items" class="anchor"></a><code><span>tkern_module_items : <span><a href="#type-tmodule_item">tmodule_item</a> list</span>;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Number of module items that are external (from <code>@sarek.module</code>). The first N items in tkern_module_items are external, the rest are inline (defined within the kernel payload). Native code gen should skip external items - they're already available via the OCaml module system.</p><span class="comment-delim">*)</span></div></li><li id="type-tkernel.tkern_external_item_count" class="def record field anchored"><a href="#type-tkernel.tkern_external_item_count" class="anchor"></a><code><span>tkern_external_item_count : int;</span></code></li><li id="type-tkernel.tkern_params" class="def record field anchored"><a href="#type-tkernel.tkern_params" class="anchor"></a><code><span>tkern_params : <span><a href="#type-tparam">tparam</a> list</span>;</span></code></li><li id="type-tkernel.tkern_body" class="def record field anchored"><a href="#type-tkernel.tkern_body" class="anchor"></a><code><span>tkern_body : <a href="#type-texpr">texpr</a>;</span></code></li><li id="type-tkernel.tkern_return_type" class="def record field anchored"><a href="#type-tkernel.tkern_return_type" class="anchor"></a><code><span>tkern_return_type : <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a>;</span></code></li><li id="type-tkernel.tkern_loc" class="def record field anchored"><a href="#type-tkernel.tkern_loc" class="anchor"></a><code><span>tkern_loc : <a href="../Sarek_ast/index.html#type-loc">Sarek_ast.loc</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Typed kernel definition</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-tdecl_item"><a href="#type-tdecl_item" class="anchor"></a><code><span><span class="keyword">type</span> tdecl_item</span><span> = </span></code><ol><li id="type-tdecl_item.TDType" class="def variant constructor anchored"><a href="#type-tdecl_item.TDType" class="anchor"></a><code><span>| </span><span><span class="constructor">TDType</span> <span class="keyword">of</span> <a href="#type-ttype_decl">ttype_decl</a></span></code></li><li id="type-tdecl_item.TDFun" class="def variant constructor anchored"><a href="#type-tdecl_item.TDFun" class="anchor"></a><code><span>| </span><span><span class="constructor">TDFun</span> <span class="keyword">of</span> string * <span><a href="#type-tparam">tparam</a> list</span> * <a href="#type-texpr">texpr</a></span></code></li><li id="type-tdecl_item.TDConst" class="def variant constructor anchored"><a href="#type-tdecl_item.TDConst" class="anchor"></a><code><span>| </span><span><span class="constructor">TDConst</span> <span class="keyword">of</span> string * int * <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> * <a href="#type-texpr">texpr</a></span></code></li></ol></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-var_id_counter"><a href="#val-var_id_counter" class="anchor"></a><code><span><span class="keyword">val</span> var_id_counter : <span>int <span class="xref-unresolved">Stdlib</span>.Atomic.t</span></span></code></div><div class="spec-doc"><p>Variable ID generator (thread-safe)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-fresh_var_id"><a href="#val-fresh_var_id" class="anchor"></a><code><span><span class="keyword">val</span> fresh_var_id : <span>unit <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-reset_var_id_counter"><a href="#val-reset_var_id_counter" class="anchor"></a><code><span><span class="keyword">val</span> reset_var_id_counter : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-mk_texpr"><a href="#val-mk_texpr" class="anchor"></a><code><span><span class="keyword">val</span> mk_texpr : <span><a href="#type-texpr_desc">texpr_desc</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../Sarek_ast/index.html#type-loc">Sarek_ast.loc</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-texpr">texpr</a></span></code></div><div class="spec-doc"><p>Create a simple typed expression</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-resolve_type"><a href="#val-resolve_type" class="anchor"></a><code><span><span class="keyword">val</span> resolve_type : <span><a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a> <span class="arrow">&#45;&gt;</span></span> <a href="../Sarek_types/index.html#type-typ">Sarek_types.typ</a></span></code></div><div class="spec-doc"><p>Get the fully resolved type (follow all links)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_texpr"><a href="#val-pp_texpr" class="anchor"></a><code><span><span class="keyword">val</span> pp_texpr : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-texpr">texpr</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Pretty printing</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_tpattern"><a href="#val-pp_tpattern" class="anchor"></a><code><span><span class="keyword">val</span> pp_tpattern : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-tpattern">tpattern</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_tparam"><a href="#val-pp_tparam" class="anchor"></a><code><span><span class="keyword">val</span> pp_tparam : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-tparam">tparam</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-pp_tkernel"><a href="#val-pp_tkernel" class="anchor"></a><code><span><span class="keyword">val</span> pp_tkernel : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-tkernel">tkernel</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>
