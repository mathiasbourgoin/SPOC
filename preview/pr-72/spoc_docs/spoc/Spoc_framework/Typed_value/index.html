<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Typed_value (spoc.Spoc_framework.Typed_value)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">spoc</a> &#x00BB; <a href="../index.html">Spoc_framework</a> &#x00BB; Typed_value</nav><header class="odoc-preamble"><h1>Module <code><span>Spoc_framework.Typed_value</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#primitive-storage">Primitive Storage</a></li><li><a href="#scalar-type-interface">Scalar Type Interface</a></li><li><a href="#composite-type-interface">Composite Type Interface</a></li><li><a href="#typed-values">Typed Values</a></li><li><a href="#vector-interface">Vector Interface</a></li><li><a href="#execution-arguments">Execution Arguments</a></li><li><a href="#type-registry">Type Registry</a></li><li><a href="#built-in-scalar-types">Built-in Scalar Types</a></li><li><a href="#convenience-functions">Convenience Functions</a></li></ul></nav></div><div class="odoc-content"><h2 id="primitive-storage"><a href="#primitive-storage" class="anchor"></a>Primitive Storage</h2><p>Efficient runtime representations for common types. Exotic types (Float128, SIMD) use PBytes.</p><div class="odoc-spec"><div class="spec type anchored" id="type-primitive"><a href="#type-primitive" class="anchor"></a><code><span><span class="keyword">type</span> primitive</span><span> = </span></code><ol><li id="type-primitive.PInt32" class="def variant constructor anchored"><a href="#type-primitive.PInt32" class="anchor"></a><code><span>| </span><span><span class="constructor">PInt32</span> <span class="keyword">of</span> int32</span></code></li><li id="type-primitive.PInt64" class="def variant constructor anchored"><a href="#type-primitive.PInt64" class="anchor"></a><code><span>| </span><span><span class="constructor">PInt64</span> <span class="keyword">of</span> int64</span></code></li><li id="type-primitive.PFloat" class="def variant constructor anchored"><a href="#type-primitive.PFloat" class="anchor"></a><code><span>| </span><span><span class="constructor">PFloat</span> <span class="keyword">of</span> float</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Used by both float32 and float64</p><span class="comment-delim">*)</span></div></li><li id="type-primitive.PBool" class="def variant constructor anchored"><a href="#type-primitive.PBool" class="anchor"></a><code><span>| </span><span><span class="constructor">PBool</span> <span class="keyword">of</span> bool</span></code></li><li id="type-primitive.PBytes" class="def variant constructor anchored"><a href="#type-primitive.PBytes" class="anchor"></a><code><span>| </span><span><span class="constructor">PBytes</span> <span class="keyword">of</span> bytes</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>For exotic scalars: Float128, SIMD, etc.</p><span class="comment-delim">*)</span></div></li></ol></div></div><h2 id="scalar-type-interface"><a href="#scalar-type-interface" class="anchor"></a>Scalar Type Interface</h2><p>Each intrinsic type (float32, float64, etc.) implements this interface. PPX generates these automatically for <code>%sarek_intrinsic</code>.</p><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-SCALAR_TYPE"><a href="#module-type-SCALAR_TYPE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-SCALAR_TYPE/index.html">SCALAR_TYPE</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="composite-type-interface"><a href="#composite-type-interface" class="anchor"></a>Composite Type Interface</h2><p>For records and structured types. Uses bytes for field serialization to avoid circular dependency with typed_value. PPX generates these automatically for <code>@@sarek.type</code>.</p><div class="odoc-spec"><div class="spec type anchored" id="type-field_desc"><a href="#type-field_desc" class="anchor"></a><code><span><span class="keyword">type</span> field_desc</span><span> = </span><span>{</span></code><ol><li id="type-field_desc.fd_name" class="def record field anchored"><a href="#type-field_desc.fd_name" class="anchor"></a><code><span>fd_name : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Field name</p><span class="comment-delim">*)</span></div></li><li id="type-field_desc.fd_type" class="def record field anchored"><a href="#type-field_desc.fd_type" class="anchor"></a><code><span>fd_type : string;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Type name for lookup</p><span class="comment-delim">*)</span></div></li><li id="type-field_desc.fd_offset" class="def record field anchored"><a href="#type-field_desc.fd_offset" class="anchor"></a><code><span>fd_offset : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Byte offset in serialized form</p><span class="comment-delim">*)</span></div></li><li id="type-field_desc.fd_size" class="def record field anchored"><a href="#type-field_desc.fd_size" class="anchor"></a><code><span>fd_size : int;</span></code><div class="def-doc"><span class="comment-delim">(*</span><p>Field size in bytes</p><span class="comment-delim">*)</span></div></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Field descriptor</p></div></div><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-COMPOSITE_TYPE"><a href="#module-type-COMPOSITE_TYPE" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-COMPOSITE_TYPE/index.html">COMPOSITE_TYPE</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="typed-values"><a href="#typed-values" class="anchor"></a>Typed Values</h2><p>Existential wrappers for type-safe value storage.</p><div class="odoc-spec"><div class="spec type anchored" id="type-scalar_value"><a href="#type-scalar_value" class="anchor"></a><code><span><span class="keyword">type</span> scalar_value</span><span> = </span></code><ol><li id="type-scalar_value.SV" class="def variant constructor anchored"><a href="#type-scalar_value.SV" class="anchor"></a><code><span>| </span><span><span class="constructor">SV</span> : <span>(<span class="keyword">module</span> <a href="module-type-SCALAR_TYPE/index.html">SCALAR_TYPE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-SCALAR_TYPE/index.html#type-t">t</a> = <span class="type-var">'a</span>)</span> * <span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span> <a href="#type-scalar_value">scalar_value</a></span></code></li></ol></div><div class="spec-doc"><p>Scalar value with its type module</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-composite_value"><a href="#type-composite_value" class="anchor"></a><code><span><span class="keyword">type</span> composite_value</span><span> = </span></code><ol><li id="type-composite_value.CV" class="def variant constructor anchored"><a href="#type-composite_value.CV" class="anchor"></a><code><span>| </span><span><span class="constructor">CV</span> : <span>(<span class="keyword">module</span> <a href="module-type-COMPOSITE_TYPE/index.html">COMPOSITE_TYPE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-COMPOSITE_TYPE/index.html#type-t">t</a> = <span class="type-var">'a</span>)</span> * <span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span> <a href="#type-composite_value">composite_value</a></span></code></li></ol></div><div class="spec-doc"><p>Composite value with its type module</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-typed_value"><a href="#type-typed_value" class="anchor"></a><code><span><span class="keyword">type</span> typed_value</span><span> = </span></code><ol><li id="type-typed_value.TV_Scalar" class="def variant constructor anchored"><a href="#type-typed_value.TV_Scalar" class="anchor"></a><code><span>| </span><span><span class="constructor">TV_Scalar</span> <span class="keyword">of</span> <a href="#type-scalar_value">scalar_value</a></span></code></li><li id="type-typed_value.TV_Composite" class="def variant constructor anchored"><a href="#type-typed_value.TV_Composite" class="anchor"></a><code><span>| </span><span><span class="constructor">TV_Composite</span> <span class="keyword">of</span> <a href="#type-composite_value">composite_value</a></span></code></li></ol></div><div class="spec-doc"><p>Unified typed value</p></div></div><h2 id="vector-interface"><a href="#vector-interface" class="anchor"></a>Vector Interface</h2><p>Abstract interface for vectors, allowing execute_direct to access vector contents without depending on the full Vector module.</p><div class="odoc-spec"><div class="spec module-type anchored" id="module-type-EXEC_VECTOR"><a href="#module-type-EXEC_VECTOR" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-EXEC_VECTOR/index.html">EXEC_VECTOR</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="execution-arguments"><a href="#execution-arguments" class="anchor"></a>Execution Arguments</h2><p>Type-safe kernel arguments for execute_direct. No Obj.t - fully typed.</p><div class="odoc-spec"><div class="spec type anchored" id="type-exec_arg"><a href="#type-exec_arg" class="anchor"></a><code><span><span class="keyword">type</span> exec_arg</span><span> = </span></code><ol><li id="type-exec_arg.EA_Int32" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Int32" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Int32</span> <span class="keyword">of</span> int32</span></code></li><li id="type-exec_arg.EA_Int64" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Int64" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Int64</span> <span class="keyword">of</span> int64</span></code></li><li id="type-exec_arg.EA_Float32" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Float32" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Float32</span> <span class="keyword">of</span> float</span></code></li><li id="type-exec_arg.EA_Float64" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Float64" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Float64</span> <span class="keyword">of</span> float</span></code></li><li id="type-exec_arg.EA_Scalar" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Scalar" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Scalar</span> : <span>(<span class="keyword">module</span> <a href="module-type-SCALAR_TYPE/index.html">SCALAR_TYPE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-SCALAR_TYPE/index.html#type-t">t</a> = <span class="type-var">'a</span>)</span> * <span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span> <a href="#type-exec_arg">exec_arg</a></span></code></li><li id="type-exec_arg.EA_Composite" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Composite" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Composite</span> : <span>(<span class="keyword">module</span> <a href="module-type-COMPOSITE_TYPE/index.html">COMPOSITE_TYPE</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-COMPOSITE_TYPE/index.html#type-t">t</a> = <span class="type-var">'a</span>)</span> * <span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span> <a href="#type-exec_arg">exec_arg</a></span></code></li><li id="type-exec_arg.EA_Vec" class="def variant constructor anchored"><a href="#type-exec_arg.EA_Vec" class="anchor"></a><code><span>| </span><span><span class="constructor">EA_Vec</span> <span class="keyword">of</span> <span>(<span class="keyword">module</span> <a href="module-type-EXEC_VECTOR/index.html">EXEC_VECTOR</a>)</span></span></code></li></ol></div></div><h2 id="type-registry"><a href="#type-registry" class="anchor"></a>Type Registry</h2><p>Global registry for type lookup by name.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Registry"><a href="#module-Registry" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Registry/index.html">Registry</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><h2 id="built-in-scalar-types"><a href="#built-in-scalar-types" class="anchor"></a>Built-in Scalar Types</h2><p>Core scalar types always available.</p><div class="odoc-spec"><div class="spec module anchored" id="module-Int32_type"><a href="#module-Int32_type" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Int32_type/index.html">Int32_type</a></span><span> : <a href="module-type-SCALAR_TYPE/index.html">SCALAR_TYPE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-SCALAR_TYPE/index.html#type-t">t</a> = int32</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Int64_type"><a href="#module-Int64_type" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Int64_type/index.html">Int64_type</a></span><span> : <a href="module-type-SCALAR_TYPE/index.html">SCALAR_TYPE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-SCALAR_TYPE/index.html#type-t">t</a> = int64</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Float32_type"><a href="#module-Float32_type" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Float32_type/index.html">Float32_type</a></span><span> : <a href="module-type-SCALAR_TYPE/index.html">SCALAR_TYPE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-SCALAR_TYPE/index.html#type-t">t</a> = float</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Float64_type"><a href="#module-Float64_type" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Float64_type/index.html">Float64_type</a></span><span> : <a href="module-type-SCALAR_TYPE/index.html">SCALAR_TYPE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-SCALAR_TYPE/index.html#type-t">t</a> = float</span></span></code></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Bool_type"><a href="#module-Bool_type" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Bool_type/index.html">Bool_type</a></span><span> : <a href="module-type-SCALAR_TYPE/index.html">SCALAR_TYPE</a> <span class="keyword">with</span> <span><span class="keyword">type</span> <a href="module-type-SCALAR_TYPE/index.html#type-t">t</a> = bool</span></span></code></div></div><h2 id="convenience-functions"><a href="#convenience-functions" class="anchor"></a>Convenience Functions</h2><div class="odoc-spec"><div class="spec value anchored" id="val-exec_arg_of_typed_value"><a href="#val-exec_arg_of_typed_value" class="anchor"></a><code><span><span class="keyword">val</span> exec_arg_of_typed_value : <span><a href="#type-typed_value">typed_value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-exec_arg">exec_arg</a></span></code></div><div class="spec-doc"><p>Create exec_arg from typed_value</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-typed_value_of_exec_arg"><a href="#val-typed_value_of_exec_arg" class="anchor"></a><code><span><span class="keyword">val</span> typed_value_of_exec_arg : <span><a href="#type-exec_arg">exec_arg</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-typed_value">typed_value</a></span></code></div><div class="spec-doc"><p>Create typed_value from exec_arg (for scalars/composites only)</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-primitive_of_scalar"><a href="#val-primitive_of_scalar" class="anchor"></a><code><span><span class="keyword">val</span> primitive_of_scalar : <span><a href="#type-scalar_value">scalar_value</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-primitive">primitive</a></span></code></div><div class="spec-doc"><p>Get primitive value from scalar_value</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-primitive_type_name"><a href="#val-primitive_type_name" class="anchor"></a><code><span><span class="keyword">val</span> primitive_type_name : <span><a href="#type-primitive">primitive</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get type name from primitive</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-typed_value_type_name"><a href="#val-typed_value_type_name" class="anchor"></a><code><span><span class="keyword">val</span> typed_value_type_name : <span><a href="#type-typed_value">typed_value</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get type name from typed_value</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-type_name_of_exec_arg"><a href="#val-type_name_of_exec_arg" class="anchor"></a><code><span><span class="keyword">val</span> type_name_of_exec_arg : <span><a href="#type-exec_arg">exec_arg</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Get type name from exec_arg</p></div></div></div></body></html>
