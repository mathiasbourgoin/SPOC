<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Metal_plugin (sarek-metal.Sarek_metal.Metal_plugin)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 3.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">Index</a> &#x00BB; <a href="../../index.html">sarek-metal</a> &#x00BB; <a href="../index.html">Sarek_metal</a> &#x00BB; Metal_plugin</nav><header class="odoc-preamble"><h1>Module <code><span>Sarek_metal.Metal_plugin</span></code></h1></header><div class="odoc-tocs"><nav class="odoc-toc odoc-local-toc"><ul><li><a href="#additional-metal-specific-functions">Additional Metal-specific Functions</a></li></ul></nav></div><div class="odoc-content"><div class="odoc-spec"><div class="spec module anchored" id="module-Metal_base"><a href="#module-Metal_base" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Metal_base/index.html">Metal_base</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Reuse the existing Metal implementation</p></div></div><div class="odoc-spec"><div class="spec type extension anchored" id="extension-decl-Metal_kargs"><a href="#extension-decl-Metal_kargs" class="anchor"></a><code><span><span class="keyword">type</span> <a href="../../../spoc/Spoc_framework/Framework_sig/index.html#type-kargs">Spoc_framework.Framework_sig.kargs</a> += </span></code><ol><li id="extension-Metal_kargs" class="def variant extension anchored"><a href="#extension-Metal_kargs" class="anchor"></a><code><span>| </span><span><span class="extension">Metal_kargs</span> <span class="keyword">of</span> <a href="../Metal_plugin_base/Metal/Kernel/index.html#type-args">Metal_base.Kernel.args</a></span></code></li></ol></div><div class="spec-doc"><p>Extend Framework_sig.kargs with Metal-specific variant</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-metal_intrinsic"><a href="#type-metal_intrinsic" class="anchor"></a><code><span><span class="keyword">type</span> metal_intrinsic</span><span> = </span><span>{</span></code><ol><li id="type-metal_intrinsic.intr_name" class="def record field anchored"><a href="#type-metal_intrinsic.intr_name" class="anchor"></a><code><span>intr_name : string;</span></code></li><li id="type-metal_intrinsic.intr_codegen" class="def record field anchored"><a href="#type-metal_intrinsic.intr_codegen" class="anchor"></a><code><span>intr_codegen : string;</span></code></li><li id="type-metal_intrinsic.intr_convergence" class="def record field anchored"><a href="#type-metal_intrinsic.intr_convergence" class="anchor"></a><code><span>intr_convergence : <a href="../../../spoc/Spoc_framework/Framework_sig/index.html#type-convergence">Spoc_framework.Framework_sig.convergence</a>;</span></code></li></ol><code><span>}</span></code></div><div class="spec-doc"><p>Metal-specific intrinsic implementation</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Metal_intrinsics"><a href="#module-Metal_intrinsics" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Metal_intrinsics/index.html">Metal_intrinsics</a></span><span> : <a href="../../../spoc/Spoc_framework/Framework_sig/module-type-INTRINSIC_REGISTRY/index.html">Spoc_framework.Framework_sig.INTRINSIC_REGISTRY</a></span></code></div><div class="spec-doc"><p>Intrinsic registry for Metal-specific intrinsics</p></div></div><div class="odoc-spec"><div class="spec module anchored" id="module-Backend"><a href="#module-Backend" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Backend/index.html">Backend</a></span><span> : <a href="../../../spoc/Spoc_framework/Framework_sig/module-type-BACKEND/index.html">Spoc_framework.Framework_sig.BACKEND</a></span></code></div><div class="spec-doc"><p>Metal Backend - implements BACKEND</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-is_disabled"><a href="#val-is_disabled" class="anchor"></a><code><span><span class="keyword">val</span> is_disabled : <span>unit <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p>Check if backend is disabled via environment variable</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-registered_backend"><a href="#val-registered_backend" class="anchor"></a><code><span><span class="keyword">val</span> registered_backend : <span>unit lazy_t</span></span></code></div><div class="spec-doc"><p>Backend registration - happens once when first needed</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-init"><a href="#val-init" class="anchor"></a><code><span><span class="keyword">val</span> init : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Force module initialization</p></div></div><h2 id="additional-metal-specific-functions"><a href="#additional-metal-specific-functions" class="anchor"></a>Additional Metal-specific Functions</h2><div class="odoc-spec"><div class="spec value anchored" id="val-register_intrinsic"><a href="#val-register_intrinsic" class="anchor"></a><code><span><span class="keyword">val</span> register_intrinsic : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="Metal_intrinsics/index.html#type-intrinsic_impl">Metal_intrinsics.intrinsic_impl</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register a custom Metal intrinsic</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-find_intrinsic"><a href="#val-find_intrinsic" class="anchor"></a><code><span><span class="keyword">val</span> find_intrinsic : <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="Metal_intrinsics/index.html#type-intrinsic_impl">Metal_intrinsics.intrinsic_impl</a> option</span></span></code></div><div class="spec-doc"><p>Look up a Metal intrinsic</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generate_with_types"><a href="#val-generate_with_types" class="anchor"></a><code><span><span class="keyword">val</span> generate_with_types : 
  <span><span class="label">types</span>:<span><span>(string * <span><span>(string * <a href="../../../spoc/Sarek_ir_types/index.html#type-elttype">Sarek_ir_types.elttype</a>)</span> list</span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><a href="../../../spoc/Sarek_ir_types/index.html#type-kernel">Sarek_ir_types.kernel</a> <span class="arrow">&#45;&gt;</span></span>
  string</span></code></div><div class="spec-doc"><p>Generate Metal source with custom types</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generate_source"><a href="#val-generate_source" class="anchor"></a><code><span><span class="keyword">val</span> generate_source : <span><a href="../../../spoc/Sarek_ir_types/index.html#type-kernel">Sarek_ir_types.kernel</a> <span class="arrow">&#45;&gt;</span></span> string</span></code></div><div class="spec-doc"><p>Generate Metal source for a kernel</p></div></div></div></body></html>
