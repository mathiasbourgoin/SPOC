<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link rel="icon" href="/Sarek/preview/pr-73/favicon.ico" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <script src="/Sarek/preview/pr-73/javascripts/process-rel-links.js" type="text/javascript"></script>
    <title>Interactive Sarek - Sarek</title>
    
    <link rel="stylesheet" href='/Sarek/preview/pr-73/stylesheets/modern.css'>
    <link rel="stylesheet" href='/Sarek/preview/pr-73/stylesheets/pygment_trac.css'>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head>
  <body>

    <!-- Top Navigation Bar -->
    <nav class="navbar">
      <div class="container">
        <a href="/Sarek/preview/pr-73/" class="nav-brand">
          <img src="/Sarek/preview/pr-73/pres_resources/logo_sarek.png" alt="Sarek Logo">
          Sarek
        </a>
        <div class="nav-links">
          <a href="/Sarek/preview/pr-73/">Home</a>
          <a href="/Sarek/preview/pr-73/docs/getting_started.html">Getting Started</a>
          <a href="/Sarek/preview/pr-73/benchmarks/">Benchmarks</a>
          <a href="/Sarek/preview/pr-73/examples/">Examples</a>
          <div class="nav-dropdown">
            <a href="#" class="dropdown-toggle">Docs â–¾</a>
            <div class="dropdown-menu">
              <a href="/Sarek/preview/pr-73/docs/concepts.html">Concepts</a>
              <a href="/Sarek/preview/pr-73/docs/architecture.html">Architecture</a>
              <a href="/Sarek/preview/pr-73/docs/backends.html">Backends</a>
              <a href="/Sarek/preview/pr-73/docs/build_guide.html">Build Guide</a>
              <a href="/Sarek/preview/pr-73/docs/faq.html">FAQ</a>
              <a href="/Sarek/preview/pr-73/docs/publications.html">Publications</a>
            </div>
          </div>
          <a href="/Sarek/preview/pr-73/spoc_docs/index.html">API</a>
          <a href="https://github.com/mathiasbourgoin/Sarek">GitHub</a>
          <button id="theme-toggle" title="Toggle Dark/Light Mode">
            <span>ðŸŒ™</span>
          </button>
        </div>
      </div>
    </nav>

    <main class="main-content">
      <div class="container">
        <h1 id="interactive-sarek-with-jupyter">Interactive Sarek with Jupyter</h1>

<p>You can use Sarek interactively using the <a href="https://github.com/akabe/ocaml-jupyter">ocaml-jupyter</a> kernel. This is an excellent way to prototype kernels, visualize GPU data, and document your experiments.</p>

<h2 id="setup">Setup</h2>

<ol>
  <li><strong>Install Jupyter and the OCaml Kernel</strong>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip <span class="nb">install </span>jupyterlab
opam <span class="nb">install </span>jupyter
ocaml-jupyter-interpreter <span class="nb">install</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Install Sarek</strong>:
Ensure Sarek and its PPX are installed in your current switch:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>opam <span class="nb">install </span>sarek sarek-cuda  <span class="c"># or your preferred backend</span>
</code></pre></div>    </div>
  </li>
  <li><strong>Launch Jupyter</strong>:
    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jupyter lab
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="using-the-native-parallel-backend">Using the Native Parallel Backend</h2>

<p>A major advantage of Sarekâ€™s modern architecture is the <strong>Native CPU backend</strong>. This is perfect for Jupyter environments (like Binder or local laptops) where a GPU might not be available.</p>

<p>You can still experiment with parallel algorithms by targeting your CPUâ€™s multiple cores:</p>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">(* 1. Initialize Sarek *)</span>
<span class="o">#</span><span class="n">require</span> <span class="s2">"sarek"</span><span class="p">;;</span>
<span class="o">#</span><span class="n">require</span> <span class="s2">"sarek.ppx"</span><span class="p">;;</span>
<span class="k">open</span> <span class="nc">Sarek</span><span class="p">;;</span>

<span class="c">(* 2. Define your parallel kernel *)</span>
<span class="k">let</span><span class="o">%</span><span class="n">kernel</span> <span class="n">compute_pi</span> <span class="p">(</span><span class="n">out</span> <span class="o">:</span> <span class="n">float32</span> <span class="n">vector</span><span class="p">)</span> <span class="p">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">int32</span><span class="p">)</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">get_global_id</span> <span class="mi">0</span> <span class="k">in</span>
  <span class="k">if</span> <span class="n">gid</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="k">then</span>
    <span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="kt">float</span> <span class="n">gid</span> <span class="o">+.</span> <span class="mi">0</span><span class="o">.</span><span class="mi">5</span><span class="p">)</span> <span class="o">/.</span> <span class="kt">float</span> <span class="n">n</span> <span class="k">in</span>
    <span class="n">out</span><span class="o">.</span><span class="p">(</span><span class="n">gid</span><span class="p">)</span> <span class="o">&lt;-</span> <span class="mi">4</span><span class="o">.</span><span class="mi">0</span> <span class="o">/.</span> <span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span> <span class="o">+.</span> <span class="n">x</span> <span class="o">*.</span> <span class="n">x</span><span class="p">)</span>

<span class="c">(* 3. Select the Native Parallel Device *)</span>
<span class="k">let</span> <span class="n">dev</span> <span class="o">=</span> <span class="nn">Device</span><span class="p">.</span><span class="n">get_device_by_name</span> <span class="s2">"Native Parallel"</span> <span class="k">in</span>
<span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">"Running on: %s</span><span class="se">\n</span><span class="s2">"</span> <span class="p">(</span><span class="nn">Device</span><span class="p">.</span><span class="n">name</span> <span class="n">dev</span><span class="p">);;</span>

<span class="c">(* 4. Execute (Runs across all available OCaml 5 Domains) *)</span>
<span class="k">let</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1000000</span> <span class="k">in</span>
<span class="k">let</span> <span class="n">results</span> <span class="o">=</span> <span class="nn">Vector</span><span class="p">.</span><span class="n">create</span> <span class="nc">Float32</span> <span class="n">n</span> <span class="k">in</span>
<span class="nn">Execute</span><span class="p">.</span><span class="n">run</span> <span class="n">compute_pi</span> <span class="o">~</span><span class="n">device</span><span class="o">:</span><span class="n">dev</span> <span class="o">~</span><span class="n">grid</span><span class="o">:</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="mi">256</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">~</span><span class="n">block</span><span class="o">:</span><span class="p">(</span><span class="mi">256</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">[</span><span class="nc">Vec</span> <span class="n">results</span><span class="p">;</span> <span class="nc">Int</span> <span class="n">n</span><span class="p">];;</span>
</code></pre></div></div>

<p>This allows you to prototype and verify the <strong>exact same logic</strong> that will later run on a high-end NVIDIA or AMD GPU.</p>

<h2 id="visualizing-results">Visualizing Results</h2>

<p>One of the big advantages of using Jupyter is the ability to render GPU results immediately. For example, after running a Mandelbrot kernel, you can use OCaml libraries to display the resulting <code class="language-plaintext highlighter-rouge">Vector</code> as an image directly in the notebook.</p>

<h2 id="try-it-online-binder">Try it Online (Binder)</h2>

<p><em>Coming Soon: We are working on a pre-configured Binder environment so you can test Sarek kernels in your browser with zero installation.</em></p>

      </div>
    </main>

    <footer>
      <div class="container">
        <p>Sarek is maintained by <a href="https://github.com/mathiasbourgoin">mathiasbourgoin</a></p>
        <p>Hosted on GitHub Pages</p>
      </div>
    </footer>

    <script src="/Sarek/preview/pr-73/javascripts/scale.fix.js"></script>
    <script src="/Sarek/preview/pr-73/javascripts/copy-code.js"></script>
    <script src="/Sarek/preview/pr-73/javascripts/theme-toggle.js"></script>
    <script src="/Sarek/preview/pr-73/javascripts/syntax-sarek.js"></script>
  </body>
</html>
